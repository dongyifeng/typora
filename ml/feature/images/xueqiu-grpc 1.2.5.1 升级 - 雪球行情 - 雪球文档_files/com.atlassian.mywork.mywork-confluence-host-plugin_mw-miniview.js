WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/util/miniview-util.js' */
var MW=MW||{$:AJS.$||Zepto};MW.Cookie=(function(){return{name:"mywork.tab.tasks",save:function(a){this.setCookie(this.name,a,7)},load:function(){return this.getCookie(this.name)=="true"},setCookie:function(c,d,e){var a="";if(e){var b=new Date();b.setTime(b.getTime()+(e*24*60*60*1000));a="; expires="+b.toGMTString()}document.cookie=c+"="+d+a+"; path=/"},getCookie:function(b){var d=b+"=";var a=document.cookie.split("; ");for(var c=0;c<a.length;c++){if(a[c].indexOf(d)===0){return a[c].substring(d.length,a[c].length)}}return null}}})();MW.Slide={FROM_RIGHT:"from-right",FROM_LEFT:"from-left"};MW.CardTransitions=(function(c){var b;var a=function(e){b=e.globalEvents};var d=function(e,i,j,k){j=j||300;var h,g;if(i===MW.Slide.FROM_RIGHT){h="right";g="left"}else{if(i===MW.Slide.FROM_LEFT){h="left";g="right"}else{h=g=""}}var f=MW.$(".showing");MW.$(".transition-finished").removeClass("transition-finished");setTimeout(function(){b.trigger("blockKeyboardShortcut");e.addClass("showing");e.show("slide",{direction:h},j,function(){b.trigger("unblockKeyboardShortcut");e.focus();e.addClass("transition-finished")});if(f.length>0&&f[0]==e[0]){if(k){k()}return}f.removeClass("showing");f.hide("slide",{direction:g},j,function(){b.trigger("cleanupNestedCard");if(k){k()}})})};a(c);return{showCard:d}});MW.$(function(a){(function(b,c){MW.$.effects.slide=function(d){return this.queue(function(){var g=MW.$(this),f=["position","top","bottom","left","right"];var k=MW.$.effects.setMode(g,d.options.mode||"show");var j=d.options.direction||"left";MW.$.effects.save(g,f);g.show();MW.$.effects.createWrapper(g).css({overflow:"hidden"});var h=(j=="up"||j=="down")?"top":"left";var e=(j=="up"||j=="left")?"pos":"neg";var l=d.options.distance||(h=="top"?g.outerHeight({margin:true}):g.outerWidth({margin:true}));if(k=="show"){g.css(h,e=="pos"?(isNaN(l)?"-"+l:-l):l)}var i={};i[h]=(k=="show"?(e=="pos"?"+=":"-="):(e=="pos"?"-=":"+="))+l;g.animate(i,{queue:false,duration:d.duration,easing:d.options.easing,complete:function(){if(k=="hide"){g.hide()}MW.$.effects.restore(g,f);b.effects.removeWrapper(g);if(d.callback){d.callback.apply(this,arguments)}g.dequeue()}})})}})(AJS.$)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/util/common-util.js' */
MW.format=function(c){var a=/^((?:(?:[^']*'){2})*?[^']*?)\{(\d+)\}/,b=/'(?!')/g;MW.format=function(g){var e=arguments,f="",d=g.match(a);while(d){g=g.substring(d[0].length);f+=d[1].replace(b,"")+(e.length>++d[2]?e[d[2]]:"");d=g.match(a)}return f+=g.replace(b,"")};return MW.format.apply(MW,arguments)};MW.formatString=function(b,a){return b.replace(/\{\{|\}\}|\{(\w+)\}/g,function(c,d){if(c=="{{"){return"{"}if(c=="}}"){return"}"}return a[d]})};MW.getParameterByNameFromHash=function(a){return MW.getParameterByName(a,window.location.hash)};MW.getParameterByName=function(b,d){b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var a="[\\?\\#&]"+b+"=([^&#]*)";var e=new RegExp(a);var c=e.exec(d||window.location.search);if(c===null){return""}else{return decodeURIComponent(c[1].replace(/\+/g," "))}};MW.setRequestTime=function(a){MW.timeDifference=new Date().getTime()-parseInt(a,10)};MW.getPrettyTime=function(d){var c=new Date(d+MW.timeDifference),b=new Date(),f=b-c,e=60000,a=60*e;if(c>=b){return "\u73b0\u5728"}else{if(f<e){return "\u5927\u7ea61\u5206\u949f\u4ee5\u524d"}else{if(f<2*e){return "1\u5206\u949f\u4ee5\u524d"}else{if(f<50*e){return AJS.format("{0}\u5206\u949f\u4ee5\u524d",Math.floor(f/e))}else{if(f<90*e){return "\u5927\u7ea61\u5c0f\u65f6\u4ee5\u524d"}else{if(f<2*a){return AJS.format("\u5927\u7ea6{0}\u5c0f\u65f6\u4ee5\u524d",Math.ceil(f/a))}else{if(f<24*a){return AJS.format("\u5927\u7ea6{0}\u5c0f\u65f6\u4ee5\u524d",Math.floor(f/a))}else{if(f<48*a){return "\u6628\u5929"}else{return AJS.format("{0}\u5929\u4ee5\u524d",Math.floor(f/(24*a)))}}}}}}}}};MW.escapeHTML=function(a){return a?a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):a};MW.pick=function(b){var a={};_.each(_.flatten(Array.prototype.slice.call(arguments,1)),function(c){if(c in b){a[c]=b[c]}});return a};MW.Deferred=function(){var a=MW.$.Deferred();return{done:_.bind(a.done,a),isResolved:_.bind(a.isResolved,a),resolveOnSuccess:function(b){return _.extend({},b,{success:function(){if(b&&b.success){b.success()}a.resolve()}})}}};MW.makeTextAreaExpandable=function(a,d){var c=a.find(".expandingArea textarea");var b=a.find(".expandingArea span");b.text(c.val());c.bind("input",function(){b.text(c.val());if(d){d()}});a.find(".expandingArea").addClass("active")};MW.getBaseUrl=function(){return window.location.href.split("/",3).join("/")+MW.contextPath};MW.createMiniviewCallback=function(b,a){var c=document.createElement("a");c.href=b;var d=c.search;if(d.length===0){d="?show-miniview"}else{if(!/[?&]show-miniview/.test(d)){d+="&show-miniview"}}if(a){d+="="+encodeURIComponent(a)}return c.pathname+d+c.hash};MW.createCallback=function(b,a){if(MW.App.parseView()!=="chrome"){if(MW.App.parseView()==="mobile"){return b+"/plugins/servlet/mobile?#mywork/notification"}else{if(!!MW.parentConfig.parentUrl){return MW.createMiniviewCallback(MW.parentConfig.parentUrl,a)}else{return b+"/plugins/servlet/notifications-miniview/notification"}}}};MW.appendCallback=function(a,c){var b=a.indexOf("%3F")<0?"?":"&";return encodeURIComponent(b+"callback="+encodeURIComponent(c))};MW.onJsonMessage=function(a){function b(c){var d=JSON.parse(c.data);a(d,c)}if(!window.addEventListener){window.attachEvent("onmessage",b)}else{window.addEventListener("message",b,false)}};MW.$(function(){MW.$.fn.visible=function(){var a=MW.$(this);return !!(a.width()||a.height())&&a.css("display")!=="none"};if(!_.groupBy){MW.$.extend(_,{groupBy:function(b,a){var c={};MW.$.each(b,function(f,h){var d=a(h);var g=(c[d]=c[d]||[]);g.push(h)});return c}})}MW.$.fn.serializeObject=function(){var c={};var b=this.serializeArray();_.each(b,function(a){if(c[a.name]!==undefined){if(!c[a.name].push){c[a.name]=[c[a.name]]}c[a.name].push(a.value||"")}else{c[a.name]=a.value||""}});return c}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/lib/underscore-min.js' */
// Underscore.js 1.3.1
// (c) 2009-2012 Jeremy Ashkenas, DocumentCloud Inc.
// Underscore is freely distributable under the MIT license.
// Portions of Underscore are inspired or borrowed from Prototype,
// Oliver Steele's Functional, and John Resig's Micro-Templating.
// For all details and documentation:
// http://documentcloud.github.com/underscore
(function(){function q(a,c,d){if(a===c)return a!==0||1/a==1/c;if(a==null||c==null)return a===c;if(a._chain)a=a._wrapped;if(c._chain)c=c._wrapped;if(a.isEqual&&b.isFunction(a.isEqual))return a.isEqual(c);if(c.isEqual&&b.isFunction(c.isEqual))return c.isEqual(a);var e=l.call(a);if(e!=l.call(c))return false;switch(e){case "[object String]":return a==String(c);case "[object Number]":return a!=+a?c!=+c:a==0?1/a==1/c:a==+c;case "[object Date]":case "[object Boolean]":return+a==+c;case "[object RegExp]":return a.source==
c.source&&a.global==c.global&&a.multiline==c.multiline&&a.ignoreCase==c.ignoreCase}if(typeof a!="object"||typeof c!="object")return false;for(var f=d.length;f--;)if(d[f]==a)return true;d.push(a);var f=0,g=true;if(e=="[object Array]"){if(f=a.length,g=f==c.length)for(;f--;)if(!(g=f in a==f in c&&q(a[f],c[f],d)))break}else{if("constructor"in a!="constructor"in c||a.constructor!=c.constructor)return false;for(var h in a)if(b.has(a,h)&&(f++,!(g=b.has(c,h)&&q(a[h],c[h],d))))break;if(g){for(h in c)if(b.has(c,
h)&&!f--)break;g=!f}}d.pop();return g}var r=this,G=r._,n={},k=Array.prototype,o=Object.prototype,i=k.slice,H=k.unshift,l=o.toString,I=o.hasOwnProperty,w=k.forEach,x=k.map,y=k.reduce,z=k.reduceRight,A=k.filter,B=k.every,C=k.some,p=k.indexOf,D=k.lastIndexOf,o=Array.isArray,J=Object.keys,s=Function.prototype.bind,b=function(a){return new m(a)};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports)exports=module.exports=b;exports._=b}else r._=b;b.VERSION="1.3.1";var j=b.each=
b.forEach=function(a,c,d){if(a!=null)if(w&&a.forEach===w)a.forEach(c,d);else if(a.length===+a.length)for(var e=0,f=a.length;e<f;e++){if(e in a&&c.call(d,a[e],e,a)===n)break}else for(e in a)if(b.has(a,e)&&c.call(d,a[e],e,a)===n)break};b.map=b.collect=function(a,c,b){var e=[];if(a==null)return e;if(x&&a.map===x)return a.map(c,b);j(a,function(a,g,h){e[e.length]=c.call(b,a,g,h)});if(a.length===+a.length)e.length=a.length;return e};b.reduce=b.foldl=b.inject=function(a,c,d,e){var f=arguments.length>2;a==
null&&(a=[]);if(y&&a.reduce===y)return e&&(c=b.bind(c,e)),f?a.reduce(c,d):a.reduce(c);j(a,function(a,b,i){f?d=c.call(e,d,a,b,i):(d=a,f=true)});if(!f)throw new TypeError("Reduce of empty array with no initial value");return d};b.reduceRight=b.foldr=function(a,c,d,e){var f=arguments.length>2;a==null&&(a=[]);if(z&&a.reduceRight===z)return e&&(c=b.bind(c,e)),f?a.reduceRight(c,d):a.reduceRight(c);var g=b.toArray(a).reverse();e&&!f&&(c=b.bind(c,e));return f?b.reduce(g,c,d,e):b.reduce(g,c)};b.find=b.detect=
function(a,c,b){var e;E(a,function(a,g,h){if(c.call(b,a,g,h))return e=a,true});return e};b.filter=b.select=function(a,c,b){var e=[];if(a==null)return e;if(A&&a.filter===A)return a.filter(c,b);j(a,function(a,g,h){c.call(b,a,g,h)&&(e[e.length]=a)});return e};b.reject=function(a,c,b){var e=[];if(a==null)return e;j(a,function(a,g,h){c.call(b,a,g,h)||(e[e.length]=a)});return e};b.every=b.all=function(a,c,b){var e=true;if(a==null)return e;if(B&&a.every===B)return a.every(c,b);j(a,function(a,g,h){if(!(e=
e&&c.call(b,a,g,h)))return n});return e};var E=b.some=b.any=function(a,c,d){c||(c=b.identity);var e=false;if(a==null)return e;if(C&&a.some===C)return a.some(c,d);j(a,function(a,b,h){if(e||(e=c.call(d,a,b,h)))return n});return!!e};b.include=b.contains=function(a,c){var b=false;if(a==null)return b;return p&&a.indexOf===p?a.indexOf(c)!=-1:b=E(a,function(a){return a===c})};b.invoke=function(a,c){var d=i.call(arguments,2);return b.map(a,function(a){return(b.isFunction(c)?c||a:a[c]).apply(a,d)})};b.pluck=
function(a,c){return b.map(a,function(a){return a[c]})};b.max=function(a,c,d){if(!c&&b.isArray(a))return Math.max.apply(Math,a);if(!c&&b.isEmpty(a))return-Infinity;var e={computed:-Infinity};j(a,function(a,b,h){b=c?c.call(d,a,b,h):a;b>=e.computed&&(e={value:a,computed:b})});return e.value};b.min=function(a,c,d){if(!c&&b.isArray(a))return Math.min.apply(Math,a);if(!c&&b.isEmpty(a))return Infinity;var e={computed:Infinity};j(a,function(a,b,h){b=c?c.call(d,a,b,h):a;b<e.computed&&(e={value:a,computed:b})});
return e.value};b.shuffle=function(a){var b=[],d;j(a,function(a,f){f==0?b[0]=a:(d=Math.floor(Math.random()*(f+1)),b[f]=b[d],b[d]=a)});return b};b.sortBy=function(a,c,d){return b.pluck(b.map(a,function(a,b,g){return{value:a,criteria:c.call(d,a,b,g)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0}),"value")};b.groupBy=function(a,c){var d={},e=b.isFunction(c)?c:function(a){return a[c]};j(a,function(a,b){var c=e(a,b);(d[c]||(d[c]=[])).push(a)});return d};b.sortedIndex=function(a,
c,d){d||(d=b.identity);for(var e=0,f=a.length;e<f;){var g=e+f>>1;d(a[g])<d(c)?e=g+1:f=g}return e};b.toArray=function(a){return!a?[]:a.toArray?a.toArray():b.isArray(a)?i.call(a):b.isArguments(a)?i.call(a):b.values(a)};b.size=function(a){return b.toArray(a).length};b.first=b.head=function(a,b,d){return b!=null&&!d?i.call(a,0,b):a[0]};b.initial=function(a,b,d){return i.call(a,0,a.length-(b==null||d?1:b))};b.last=function(a,b,d){return b!=null&&!d?i.call(a,Math.max(a.length-b,0)):a[a.length-1]};b.rest=
b.tail=function(a,b,d){return i.call(a,b==null||d?1:b)};b.compact=function(a){return b.filter(a,function(a){return!!a})};b.flatten=function(a,c){return b.reduce(a,function(a,e){if(b.isArray(e))return a.concat(c?e:b.flatten(e));a[a.length]=e;return a},[])};b.without=function(a){return b.difference(a,i.call(arguments,1))};b.uniq=b.unique=function(a,c,d){var d=d?b.map(a,d):a,e=[];b.reduce(d,function(d,g,h){if(0==h||(c===true?b.last(d)!=g:!b.include(d,g)))d[d.length]=g,e[e.length]=a[h];return d},[]);
return e};b.union=function(){return b.uniq(b.flatten(arguments,true))};b.intersection=b.intersect=function(a){var c=i.call(arguments,1);return b.filter(b.uniq(a),function(a){return b.every(c,function(c){return b.indexOf(c,a)>=0})})};b.difference=function(a){var c=b.flatten(i.call(arguments,1));return b.filter(a,function(a){return!b.include(c,a)})};b.zip=function(){for(var a=i.call(arguments),c=b.max(b.pluck(a,"length")),d=Array(c),e=0;e<c;e++)d[e]=b.pluck(a,""+e);return d};b.indexOf=function(a,c,
d){if(a==null)return-1;var e;if(d)return d=b.sortedIndex(a,c),a[d]===c?d:-1;if(p&&a.indexOf===p)return a.indexOf(c);for(d=0,e=a.length;d<e;d++)if(d in a&&a[d]===c)return d;return-1};b.lastIndexOf=function(a,b){if(a==null)return-1;if(D&&a.lastIndexOf===D)return a.lastIndexOf(b);for(var d=a.length;d--;)if(d in a&&a[d]===b)return d;return-1};b.range=function(a,b,d){arguments.length<=1&&(b=a||0,a=0);for(var d=arguments[2]||1,e=Math.max(Math.ceil((b-a)/d),0),f=0,g=Array(e);f<e;)g[f++]=a,a+=d;return g};
var F=function(){};b.bind=function(a,c){var d,e;if(a.bind===s&&s)return s.apply(a,i.call(arguments,1));if(!b.isFunction(a))throw new TypeError;e=i.call(arguments,2);return d=function(){if(!(this instanceof d))return a.apply(c,e.concat(i.call(arguments)));F.prototype=a.prototype;var b=new F,g=a.apply(b,e.concat(i.call(arguments)));return Object(g)===g?g:b}};b.bindAll=function(a){var c=i.call(arguments,1);c.length==0&&(c=b.functions(a));j(c,function(c){a[c]=b.bind(a[c],a)});return a};b.memoize=function(a,
c){var d={};c||(c=b.identity);return function(){var e=c.apply(this,arguments);return b.has(d,e)?d[e]:d[e]=a.apply(this,arguments)}};b.delay=function(a,b){var d=i.call(arguments,2);return setTimeout(function(){return a.apply(a,d)},b)};b.defer=function(a){return b.delay.apply(b,[a,1].concat(i.call(arguments,1)))};b.throttle=function(a,c){var d,e,f,g,h,i=b.debounce(function(){h=g=false},c);return function(){d=this;e=arguments;var b;f||(f=setTimeout(function(){f=null;h&&a.apply(d,e);i()},c));g?h=true:
a.apply(d,e);i();g=true}};b.debounce=function(a,b){var d;return function(){var e=this,f=arguments;clearTimeout(d);d=setTimeout(function(){d=null;a.apply(e,f)},b)}};b.once=function(a){var b=false,d;return function(){if(b)return d;b=true;return d=a.apply(this,arguments)}};b.wrap=function(a,b){return function(){var d=[a].concat(i.call(arguments,0));return b.apply(this,d)}};b.compose=function(){var a=arguments;return function(){for(var b=arguments,d=a.length-1;d>=0;d--)b=[a[d].apply(this,b)];return b[0]}};
b.after=function(a,b){return a<=0?b():function(){if(--a<1)return b.apply(this,arguments)}};b.keys=J||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var c=[],d;for(d in a)b.has(a,d)&&(c[c.length]=d);return c};b.values=function(a){return b.map(a,b.identity)};b.functions=b.methods=function(a){var c=[],d;for(d in a)b.isFunction(a[d])&&c.push(d);return c.sort()};b.extend=function(a){j(i.call(arguments,1),function(b){for(var d in b)a[d]=b[d]});return a};b.defaults=function(a){j(i.call(arguments,
1),function(b){for(var d in b)a[d]==null&&(a[d]=b[d])});return a};b.clone=function(a){return!b.isObject(a)?a:b.isArray(a)?a.slice():b.extend({},a)};b.tap=function(a,b){b(a);return a};b.isEqual=function(a,b){return q(a,b,[])};b.isEmpty=function(a){if(b.isArray(a)||b.isString(a))return a.length===0;for(var c in a)if(b.has(a,c))return false;return true};b.isElement=function(a){return!!(a&&a.nodeType==1)};b.isArray=o||function(a){return l.call(a)=="[object Array]"};b.isObject=function(a){return a===Object(a)};
b.isArguments=function(a){return l.call(a)=="[object Arguments]"};if(!b.isArguments(arguments))b.isArguments=function(a){return!(!a||!b.has(a,"callee"))};b.isFunction=function(a){return l.call(a)=="[object Function]"};b.isString=function(a){return l.call(a)=="[object String]"};b.isNumber=function(a){return l.call(a)=="[object Number]"};b.isNaN=function(a){return a!==a};b.isBoolean=function(a){return a===true||a===false||l.call(a)=="[object Boolean]"};b.isDate=function(a){return l.call(a)=="[object Date]"};
b.isRegExp=function(a){return l.call(a)=="[object RegExp]"};b.isNull=function(a){return a===null};b.isUndefined=function(a){return a===void 0};b.has=function(a,b){return I.call(a,b)};b.noConflict=function(){r._=G;return this};b.identity=function(a){return a};b.times=function(a,b,d){for(var e=0;e<a;e++)b.call(d,e)};b.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};b.mixin=function(a){j(b.functions(a),
function(c){K(c,b[c]=a[c])})};var L=0;b.uniqueId=function(a){var b=L++;return a?a+b:b};b.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var t=/.^/,u=function(a){return a.replace(/\\\\/g,"\\").replace(/\\'/g,"'")};b.template=function(a,c){var d=b.templateSettings,d="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(d.escape||t,function(a,b){return"',_.escape("+
u(b)+"),'"}).replace(d.interpolate||t,function(a,b){return"',"+u(b)+",'"}).replace(d.evaluate||t,function(a,b){return"');"+u(b).replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",e=new Function("obj","_",d);return c?e(c,b):function(a){return e.call(this,a,b)}};b.chain=function(a){return b(a).chain()};var m=function(a){this._wrapped=a};b.prototype=m.prototype;var v=function(a,c){return c?b(a).chain():a},K=function(a,c){m.prototype[a]=
function(){var a=i.call(arguments);H.call(a,this._wrapped);return v(c.apply(b,a),this._chain)}};b.mixin(b);j("pop,push,reverse,shift,sort,splice,unshift".split(","),function(a){var b=k[a];m.prototype[a]=function(){var d=this._wrapped;b.apply(d,arguments);var e=d.length;(a=="shift"||a=="splice")&&e===0&&delete d[0];return v(d,this._chain)}});j(["concat","join","slice"],function(a){var b=k[a];m.prototype[a]=function(){return v(b.apply(this._wrapped,arguments),this._chain)}});m.prototype.chain=function(){this._chain=
true;return this};m.prototype.value=function(){return this._wrapped}}).call(this);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/lib/backbone-min.js' */
// Backbone.js 0.9.2

// (c) 2010-2012 Jeremy Ashkenas, DocumentCloud Inc.
// Backbone may be freely distributed under the MIT license.
// For all details and documentation:
// http://backbonejs.org
(function(){var l=this,y=l.Backbone,z=Array.prototype.slice,A=Array.prototype.splice,g;g="undefined"!==typeof exports?exports:l.Backbone={};g.VERSION="0.9.2";var f=l._;!f&&"undefined"!==typeof require&&(f=require("underscore"));var i=l.jQuery||l.Zepto||l.ender;g.setDomLibrary=function(a){i=a};g.noConflict=function(){l.Backbone=y;return this};g.emulateHTTP=!1;g.emulateJSON=!1;var p=/\s+/,k=g.Events={on:function(a,b,c){var d,e,f,g,j;if(!b)return this;a=a.split(p);for(d=this._callbacks||(this._callbacks=
{});e=a.shift();)f=(j=d[e])?j.tail:{},f.next=g={},f.context=c,f.callback=b,d[e]={tail:g,next:j?j.next:f};return this},off:function(a,b,c){var d,e,h,g,j,q;if(e=this._callbacks){if(!a&&!b&&!c)return delete this._callbacks,this;for(a=a?a.split(p):f.keys(e);d=a.shift();)if(h=e[d],delete e[d],h&&(b||c))for(g=h.tail;(h=h.next)!==g;)if(j=h.callback,q=h.context,b&&j!==b||c&&q!==c)this.on(d,j,q);return this}},trigger:function(a){var b,c,d,e,f,g;if(!(d=this._callbacks))return this;f=d.all;a=a.split(p);for(g=
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         z.call(arguments,1);b=a.shift();){if(c=d[b])for(e=c.tail;(c=c.next)!==e;)c.callback.apply(c.context||this,g);if(c=f){e=c.tail;for(b=[b].concat(g);(c=c.next)!==e;)c.callback.apply(c.context||this,b)}}return this}};k.bind=k.on;k.unbind=k.off;var o=g.Model=function(a,b){var c;a||(a={});b&&b.parse&&(a=this.parse(a));if(c=n(this,"defaults"))a=f.extend({},c,a);b&&b.collection&&(this.collection=b.collection);this.attributes={};this._escapedAttributes={};this.cid=f.uniqueId("c");this.changed={};this._silent=
{};this._pending={};this.set(a,{silent:!0});this.changed={};this._silent={};this._pending={};this._previousAttributes=f.clone(this.attributes);this.initialize.apply(this,arguments)};f.extend(o.prototype,k,{changed:null,_silent:null,_pending:null,idAttribute:"id",initialize:function(){},toJSON:function(){return f.clone(this.attributes)},get:function(a){return this.attributes[a]},escape:function(a){var b;if(b=this._escapedAttributes[a])return b;b=this.get(a);return this._escapedAttributes[a]=f.escape(null==
    b?"":""+b)},has:function(a){return null!=this.get(a)},set:function(a,b,c){var d,e;f.isObject(a)||null==a?(d=a,c=b):(d={},d[a]=b);c||(c={});if(!d)return this;d instanceof o&&(d=d.attributes);if(c.unset)for(e in d)d[e]=void 0;if(!this._validate(d,c))return!1;this.idAttribute in d&&(this.id=d[this.idAttribute]);var b=c.changes={},h=this.attributes,g=this._escapedAttributes,j=this._previousAttributes||{};for(e in d){a=d[e];if(!f.isEqual(h[e],a)||c.unset&&f.has(h,e))delete g[e],(c.silent?this._silent:
    b)[e]=!0;c.unset?delete h[e]:h[e]=a;!f.isEqual(j[e],a)||f.has(h,e)!=f.has(j,e)?(this.changed[e]=a,c.silent||(this._pending[e]=!0)):(delete this.changed[e],delete this._pending[e])}c.silent||this.change(c);return this},unset:function(a,b){(b||(b={})).unset=!0;return this.set(a,null,b)},clear:function(a){(a||(a={})).unset=!0;return this.set(f.clone(this.attributes),a)},fetch:function(a){var a=a?f.clone(a):{},b=this,c=a.success;a.success=function(d,e,f){if(!b.set(b.parse(d,f),a))return!1;c&&c(b,d)};
    a.error=g.wrapError(a.error,b,a);return(this.sync||g.sync).call(this,"read",this,a)},save:function(a,b,c){var d,e;f.isObject(a)||null==a?(d=a,c=b):(d={},d[a]=b);c=c?f.clone(c):{};if(c.wait){if(!this._validate(d,c))return!1;e=f.clone(this.attributes)}a=f.extend({},c,{silent:!0});if(d&&!this.set(d,c.wait?a:c))return!1;var h=this,i=c.success;c.success=function(a,b,e){b=h.parse(a,e);if(c.wait){delete c.wait;b=f.extend(d||{},b)}if(!h.set(b,c))return false;i?i(h,a):h.trigger("sync",h,a,c)};c.error=g.wrapError(c.error,
    h,c);b=this.isNew()?"create":"update";b=(this.sync||g.sync).call(this,b,this,c);c.wait&&this.set(e,a);return b},destroy:function(a){var a=a?f.clone(a):{},b=this,c=a.success,d=function(){b.trigger("destroy",b,b.collection,a)};if(this.isNew())return d(),!1;a.success=function(e){a.wait&&d();c?c(b,e):b.trigger("sync",b,e,a)};a.error=g.wrapError(a.error,b,a);var e=(this.sync||g.sync).call(this,"delete",this,a);a.wait||d();return e},url:function(){var a=n(this,"urlRoot")||n(this.collection,"url")||t();
    return this.isNew()?a:a+("/"==a.charAt(a.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(a){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},change:function(a){a||(a={});var b=this._changing;this._changing=!0;for(var c in this._silent)this._pending[c]=!0;var d=f.extend({},a.changes,this._silent);this._silent={};for(c in d)this.trigger("change:"+c,this,this.get(c),a);if(b)return this;for(;!f.isEmpty(this._pending);){this._pending=
{};this.trigger("change",this,a);for(c in this.changed)!this._pending[c]&&!this._silent[c]&&delete this.changed[c];this._previousAttributes=f.clone(this.attributes)}this._changing=!1;return this},hasChanged:function(a){return!arguments.length?!f.isEmpty(this.changed):f.has(this.changed,a)},changedAttributes:function(a){if(!a)return this.hasChanged()?f.clone(this.changed):!1;var b,c=!1,d=this._previousAttributes,e;for(e in a)if(!f.isEqual(d[e],b=a[e]))(c||(c={}))[e]=b;return c},previous:function(a){return!arguments.length||
    !this._previousAttributes?null:this._previousAttributes[a]},previousAttributes:function(){return f.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(a,b){if(b.silent||!this.validate)return!0;var a=f.extend({},this.attributes,a),c=this.validate(a,b);if(!c)return!0;b&&b.error?b.error(this,c,b):this.trigger("error",this,c,b);return!1}});var r=g.Collection=function(a,b){b||(b={});b.model&&(this.model=b.model);b.comparator&&(this.comparator=b.comparator);
    this._reset();this.initialize.apply(this,arguments);a&&this.reset(a,{silent:!0,parse:b.parse})};f.extend(r.prototype,k,{model:o,initialize:function(){},toJSON:function(a){return this.map(function(b){return b.toJSON(a)})},add:function(a,b){var c,d,e,g,i,j={},k={},l=[];b||(b={});a=f.isArray(a)?a.slice():[a];c=0;for(d=a.length;c<d;c++){if(!(e=a[c]=this._prepareModel(a[c],b)))throw Error("Can't add an invalid model to a collection");g=e.cid;i=e.id;j[g]||this._byCid[g]||null!=i&&(k[i]||this._byId[i])?
    l.push(c):j[g]=k[i]=e}for(c=l.length;c--;)a.splice(l[c],1);c=0;for(d=a.length;c<d;c++)(e=a[c]).on("all",this._onModelEvent,this),this._byCid[e.cid]=e,null!=e.id&&(this._byId[e.id]=e);this.length+=d;A.apply(this.models,[null!=b.at?b.at:this.models.length,0].concat(a));this.comparator&&this.sort({silent:!0});if(b.silent)return this;c=0;for(d=this.models.length;c<d;c++)if(j[(e=this.models[c]).cid])b.index=c,e.trigger("add",e,this,b);return this},remove:function(a,b){var c,d,e,g;b||(b={});a=f.isArray(a)?
    a.slice():[a];c=0;for(d=a.length;c<d;c++)if(g=this.getByCid(a[c])||this.get(a[c]))delete this._byId[g.id],delete this._byCid[g.cid],e=this.indexOf(g),this.models.splice(e,1),this.length--,b.silent||(b.index=e,g.trigger("remove",g,this,b)),this._removeReference(g);return this},push:function(a,b){a=this._prepareModel(a,b);this.add(a,b);return a},pop:function(a){var b=this.at(this.length-1);this.remove(b,a);return b},unshift:function(a,b){a=this._prepareModel(a,b);this.add(a,f.extend({at:0},b));return a},
    shift:function(a){var b=this.at(0);this.remove(b,a);return b},get:function(a){return null==a?void 0:this._byId[null!=a.id?a.id:a]},getByCid:function(a){return a&&this._byCid[a.cid||a]},at:function(a){return this.models[a]},where:function(a){return f.isEmpty(a)?[]:this.filter(function(b){for(var c in a)if(a[c]!==b.get(c))return!1;return!0})},sort:function(a){a||(a={});if(!this.comparator)throw Error("Cannot sort a set without a comparator");var b=f.bind(this.comparator,this);1==this.comparator.length?
        this.models=this.sortBy(b):this.models.sort(b);a.silent||this.trigger("reset",this,a);return this},pluck:function(a){return f.map(this.models,function(b){return b.get(a)})},reset:function(a,b){a||(a=[]);b||(b={});for(var c=0,d=this.models.length;c<d;c++)this._removeReference(this.models[c]);this._reset();this.add(a,f.extend({silent:!0},b));b.silent||this.trigger("reset",this,b);return this},fetch:function(a){a=a?f.clone(a):{};void 0===a.parse&&(a.parse=!0);var b=this,c=a.success;a.success=function(d,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               e,f){b[a.add?"add":"reset"](b.parse(d,f),a);c&&c(b,d)};a.error=g.wrapError(a.error,b,a);return(this.sync||g.sync).call(this,"read",this,a)},create:function(a,b){var c=this,b=b?f.clone(b):{},a=this._prepareModel(a,b);if(!a)return!1;b.wait||c.add(a,b);var d=b.success;b.success=function(e,f){b.wait&&c.add(e,b);d?d(e,f):e.trigger("sync",a,f,b)};a.save(null,b);return a},parse:function(a){return a},chain:function(){return f(this.models).chain()},_reset:function(){this.length=0;this.models=[];this._byId=
    {};this._byCid={}},_prepareModel:function(a,b){b||(b={});a instanceof o?a.collection||(a.collection=this):(b.collection=this,a=new this.model(a,b),a._validate(a.attributes,b)||(a=!1));return a},_removeReference:function(a){this==a.collection&&delete a.collection;a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){("add"==a||"remove"==a)&&c!=this||("destroy"==a&&this.remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],this._byId[b.id]=b),this.trigger.apply(this,
        arguments))}});f.each("forEach,each,map,reduce,reduceRight,find,detect,filter,select,reject,every,all,some,any,include,contains,invoke,max,min,sortBy,sortedIndex,toArray,size,first,initial,rest,last,without,indexOf,shuffle,lastIndexOf,isEmpty,groupBy".split(","),function(a){r.prototype[a]=function(){return f[a].apply(f,[this.models].concat(f.toArray(arguments)))}});var u=g.Router=function(a){a||(a={});a.routes&&(this.routes=a.routes);this._bindRoutes();this.initialize.apply(this,arguments)},B=/:\w+/g,
    C=/\*\w+/g,D=/[-[\]{}()+?.,\\^$|#\s]/g;f.extend(u.prototype,k,{initialize:function(){},route:function(a,b,c){g.history||(g.history=new m);f.isRegExp(a)||(a=this._routeToRegExp(a));c||(c=this[b]);g.history.route(a,f.bind(function(d){d=this._extractParameters(a,d);c&&c.apply(this,d);this.trigger.apply(this,["route:"+b].concat(d));g.history.trigger("route",this,b,d)},this));return this},navigate:function(a,b){g.history.navigate(a,b)},_bindRoutes:function(){if(this.routes){var a=[],b;for(b in this.routes)a.unshift([b,
    this.routes[b]]);b=0;for(var c=a.length;b<c;b++)this.route(a[b][0],a[b][1],this[a[b][1]])}},_routeToRegExp:function(a){a=a.replace(D,"\\$&").replace(B,"([^/]+)").replace(C,"(.*?)");return RegExp("^"+a+"$")},_extractParameters:function(a,b){return a.exec(b).slice(1)}});var m=g.History=function(){this.handlers=[];f.bindAll(this,"checkUrl")},s=/^[#\/]/,E=/msie [\w.]+/;m.started=!1;f.extend(m.prototype,k,{interval:50,getHash:function(a){return(a=(a?a.location:window.location).href.match(/#(.*)$/))?a[1]:
    ""},getFragment:function(a,b){if(null==a)if(this._hasPushState||b){var a=window.location.pathname,c=window.location.search;c&&(a+=c)}else a=this.getHash();a.indexOf(this.options.root)||(a=a.substr(this.options.root.length));return a.replace(s,"")},start:function(a){if(m.started)throw Error("Backbone.history has already been started");m.started=!0;this.options=f.extend({},{root:"/"},this.options,a);this._wantsHashChange=!1!==this.options.hashChange;this._wantsPushState=!!this.options.pushState;this._hasPushState=
    !(!this.options.pushState||!window.history||!window.history.pushState);var a=this.getFragment(),b=document.documentMode;if(b=E.exec(navigator.userAgent.toLowerCase())&&(!b||7>=b))this.iframe=i('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(a);this._hasPushState?i(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!b?i(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,
    this.interval));this.fragment=a;a=window.location;b=a.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!b)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&b&&a.hash&&(this.fragment=this.getHash().replace(s,""),window.history.replaceState({},document.title,a.protocol+"//"+a.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},
    stop:function(){i(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);m.started=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(){var a=this.getFragment();a==this.fragment&&this.iframe&&(a=this.getFragment(this.getHash(this.iframe)));if(a==this.fragment)return!1;this.iframe&&this.navigate(a);this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(a){var b=this.fragment=this.getFragment(a);return f.any(this.handlers,
        function(a){if(a.route.test(b))return a.callback(b),!0})},navigate:function(a,b){if(!m.started)return!1;if(!b||!0===b)b={trigger:b};var c=(a||"").replace(s,"");this.fragment!=c&&(this._hasPushState?(0!=c.indexOf(this.options.root)&&(c=this.options.root+c),this.fragment=c,window.history[b.replace?"replaceState":"pushState"]({},document.title,c)):this._wantsHashChange?(this.fragment=c,this._updateHash(window.location,c,b.replace),this.iframe&&c!=this.getFragment(this.getHash(this.iframe))&&(b.replace||
        this.iframe.document.open().close(),this._updateHash(this.iframe.location,c,b.replace))):window.location.assign(this.options.root+a),b.trigger&&this.loadUrl(a))},_updateHash:function(a,b,c){c?a.replace(a.toString().replace(/(javascript:|#).*$/,"")+"#"+b):a.hash=b}});var v=g.View=function(a){this.cid=f.uniqueId("view");this._configure(a||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()},F=/^(\S+)\s*(.*)$/,w="model,collection,el,id,attributes,className,tagName".split(",");
    f.extend(v.prototype,k,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();return this},make:function(a,b,c){a=document.createElement(a);b&&i(a).attr(b);c&&i(a).html(c);return a},setElement:function(a,b){this.$el&&this.undelegateEvents();this.$el=a instanceof i?a:i(a);this.el=this.$el[0];!1!==b&&this.delegateEvents();return this},delegateEvents:function(a){if(a||(a=n(this,"events"))){this.undelegateEvents();
        for(var b in a){var c=a[b];f.isFunction(c)||(c=this[a[b]]);if(!c)throw Error('Method "'+a[b]+'" does not exist');var d=b.match(F),e=d[1],d=d[2],c=f.bind(c,this),e=e+(".delegateEvents"+this.cid);""===d?this.$el.bind(e,c):this.$el.delegate(d,e,c)}}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(a){this.options&&(a=f.extend({},this.options,a));for(var b=0,c=w.length;b<c;b++){var d=w[b];a[d]&&(this[d]=a[d])}this.options=a},_ensureElement:function(){if(this.el)this.setElement(this.el,
        !1);else{var a=n(this,"attributes")||{};this.id&&(a.id=this.id);this.className&&(a["class"]=this.className);this.setElement(this.make(this.tagName,a),!1)}}});o.extend=r.extend=u.extend=v.extend=function(a,b){var c=G(this,a,b);c.extend=this.extend;return c};var H={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};g.sync=function(a,b,c){var d=H[a];c||(c={});var e={type:d,dataType:"json"};c.url||(e.url=n(b,"url")||t());if(!c.data&&b&&("create"==a||"update"==a))e.contentType="application/json",
        e.data=JSON.stringify(b.toJSON());g.emulateJSON&&(e.contentType="application/x-www-form-urlencoded",e.data=e.data?{model:e.data}:{});if(g.emulateHTTP&&("PUT"===d||"DELETE"===d))g.emulateJSON&&(e.data._method=d),e.type="POST",e.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",d)};"GET"!==e.type&&!g.emulateJSON&&(e.processData=!1);return i.ajax(f.extend(e,c))};g.wrapError=function(a,b,c){return function(d,e){e=d===b?e:d;a?a(b,e,c):b.trigger("error",b,e,c)}};var x=function(){},G=function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    b,c){var d;d=b&&b.hasOwnProperty("constructor")?b.constructor:function(){a.apply(this,arguments)};f.extend(d,a);x.prototype=a.prototype;d.prototype=new x;b&&f.extend(d.prototype,b);c&&f.extend(d,c);d.prototype.constructor=d;d.__super__=a.prototype;return d},n=function(a,b){return!a||!a[b]?null:f.isFunction(a[b])?a[b]():a[b]},t=function(){throw Error('A "url" property or function must be specified');}}).call(this);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/lib/jquery.effects.core.js' */
jQuery.effects||(function(h,e){h.effects={};h.each(["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","borderColor","color","outlineColor"],function(n,m){h.fx.step[m]=function(o){if(!o.colorInit){o.start=l(o.elem,m);o.end=j(o.end);o.colorInit=true}o.elem.style[m]="rgb("+Math.max(Math.min(parseInt((o.pos*(o.end[0]-o.start[0]))+o.start[0],10),255),0)+","+Math.max(Math.min(parseInt((o.pos*(o.end[1]-o.start[1]))+o.start[1],10),255),0)+","+Math.max(Math.min(parseInt((o.pos*(o.end[2]-o.start[2]))+o.start[2],10),255),0)+")"}});function j(n){var m;if(n&&n.constructor==Array&&n.length==3){return n}if(m=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(n)){return[parseInt(m[1],10),parseInt(m[2],10),parseInt(m[3],10)]}if(m=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(n)){return[parseFloat(m[1])*2.55,parseFloat(m[2])*2.55,parseFloat(m[3])*2.55]}if(m=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(n)){return[parseInt(m[1],16),parseInt(m[2],16),parseInt(m[3],16)]}if(m=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(n)){return[parseInt(m[1]+m[1],16),parseInt(m[2]+m[2],16),parseInt(m[3]+m[3],16)]}if(m=/rgba\(0, 0, 0, 0\)/.exec(n)){return a.transparent}return a[h.trim(n).toLowerCase()]}function l(o,m){var n;do{n=h.curCSS(o,m);if(n!=""&&n!="transparent"||h.nodeName(o,"body")){break}m="backgroundColor"}while(o=o.parentNode);return j(n)}var a={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0],transparent:[255,255,255]};var f=["add","remove","toggle"],c={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};function g(){var p=document.defaultView?document.defaultView.getComputedStyle(this,null):this.currentStyle,q={},n,o;if(p&&p.length&&p[0]&&p[p[0]]){var m=p.length;while(m--){n=p[m];if(typeof p[n]=="string"){o=n.replace(/\-(\w)/g,function(r,s){return s.toUpperCase()});q[o]=p[n]}}}else{for(n in p){if(typeof p[n]==="string"){q[n]=p[n]}}}return q}function b(n){var m,o;for(m in n){o=n[m];if(o==null||h.isFunction(o)||m in c||(/scrollbar/).test(m)||(!(/color/i).test(m)&&isNaN(parseFloat(o)))){delete n[m]}}return n}function i(m,o){var p={_:0},n;for(n in o){if(m[n]!=o[n]){p[n]=o[n]}}return p}h.effects.animateClass=function(m,n,p,o){if(h.isFunction(p)){o=p;p=null}return this.queue(function(){var t=h(this),q=t.attr("style")||" ",u=b(g.call(this)),s,r=t.attr("class");h.each(f,function(v,w){if(m[w]){t[w+"Class"](m[w])}});s=b(g.call(this));t.attr("class",r);t.animate(i(u,s),{queue:false,duration:n,easing:p,complete:function(){h.each(f,function(v,w){if(m[w]){t[w+"Class"](m[w])}});if(typeof t.attr("style")=="object"){t.attr("style").cssText="";t.attr("style").cssText=q}else{t.attr("style",q)}if(o){o.apply(this,arguments)}h.dequeue(this)}})})};h.fn.extend({_addClass:h.fn.addClass,addClass:function(n,m,p,o){return m?h.effects.animateClass.apply(this,[{add:n},m,p,o]):this._addClass(n)},_removeClass:h.fn.removeClass,removeClass:function(n,m,p,o){return m?h.effects.animateClass.apply(this,[{remove:n},m,p,o]):this._removeClass(n)},_toggleClass:h.fn.toggleClass,toggleClass:function(o,n,m,q,p){if(typeof n=="boolean"||n===e){if(!m){return this._toggleClass(o,n)}else{return h.effects.animateClass.apply(this,[(n?{add:o}:{remove:o}),m,q,p])}}else{return h.effects.animateClass.apply(this,[{toggle:o},n,m,q])}},switchClass:function(m,o,n,q,p){return h.effects.animateClass.apply(this,[{add:o,remove:m},n,q,p])}});h.extend(h.effects,{version:"@VERSION",save:function(n,o){for(var m=0;m<o.length;m++){if(o[m]!==null){n.data("ec.storage."+o[m],n[0].style[o[m]])}}},restore:function(n,o){for(var m=0;m<o.length;m++){if(o[m]!==null){n.css(o[m],n.data("ec.storage."+o[m]))}}},setMode:function(m,n){if(n=="toggle"){n=m.is(":hidden")?"show":"hide"}return n},getBaseline:function(n,o){var p,m;switch(n[0]){case"top":p=0;break;case"middle":p=0.5;break;case"bottom":p=1;break;default:p=n[0]/o.height}switch(n[1]){case"left":m=0;break;case"center":m=0.5;break;case"right":m=1;break;default:m=n[1]/o.width}return{x:m,y:p}},createWrapper:function(m){if(m.parent().is(".ui-effects-wrapper")){return m.parent()}var n={width:m.outerWidth(true),height:m.outerHeight(true),"float":m.css("float")},p=h("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),o=document.activeElement;m.wrap(p);if(m[0]===o||h.contains(m[0],o)){h(o).focus()}p=m.parent();if(m.css("position")=="static"){p.css({position:"relative"});m.css({position:"relative"})}else{h.extend(n,{position:m.css("position"),zIndex:m.css("z-index")});h.each(["top","left","bottom","right"],function(q,r){n[r]=m.css(r);if(isNaN(parseInt(n[r],10))){n[r]="auto"}});m.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})}return p.css(n).show()},removeWrapper:function(m){var n,o=document.activeElement;if(m.parent().is(".ui-effects-wrapper")){n=m.parent().replaceWith(m);if(m[0]===o||h.contains(m[0],o)){h(o).focus()}return n}return m},setTransition:function(n,p,m,o){o=o||{};h.each(p,function(r,q){unit=n.cssUnit(q);if(unit[0]>0){o[q]=unit[0]*m+unit[1]}});return o}});function d(n,m,o,p){if(typeof n=="object"){p=m;o=null;m=n;n=m.effect}if(h.isFunction(m)){p=m;o=null;m={}}if(typeof m=="number"||h.fx.speeds[m]){p=o;o=m;m={}}if(h.isFunction(o)){p=o;o=null}m=m||{};o=o||m.duration;o=h.fx.off?0:typeof o=="number"?o:o in h.fx.speeds?h.fx.speeds[o]:h.fx.speeds._default;p=p||m.complete;return[n,m,o,p]}function k(m){if(!m||typeof m==="number"||h.fx.speeds[m]){return true}if(typeof m==="string"&&!h.effects[m]){return true}return false}h.fn.extend({effect:function(p,o,r,t){var n=d.apply(this,arguments),q={options:n[1],duration:n[2],callback:n[3]},s=q.options.mode,m=h.effects[p];if(h.fx.off||!m){if(s){return this[s](q.duration,q.callback)}else{return this.each(function(){if(q.callback){q.callback.call(this)}})}}return m.call(this,q)},_show:h.fn.show,show:function(n){if(k(n)){return this._show.apply(this,arguments)}else{var m=d.apply(this,arguments);m[1].mode="show";return this.effect.apply(this,m)}},_hide:h.fn.hide,hide:function(n){if(k(n)){return this._hide.apply(this,arguments)}else{var m=d.apply(this,arguments);m[1].mode="hide";return this.effect.apply(this,m)}},__toggle:h.fn.toggle,toggle:function(n){if(k(n)||typeof n==="boolean"||h.isFunction(n)){return this.__toggle.apply(this,arguments)}else{var m=d.apply(this,arguments);m[1].mode="toggle";return this.effect.apply(this,m)}},cssUnit:function(m){var n=this.css(m),o=[];h.each(["em","px","%","pt"],function(p,q){if(n.indexOf(q)>0){o=[parseFloat(n),q]}});return o}});h.easing.jswing=h.easing.swing;h.extend(h.easing,{def:"easeOutQuad",swing:function(n,o,m,q,p){return h.easing[h.easing.def](n,o,m,q,p)},easeInQuad:function(n,o,m,q,p){return q*(o/=p)*o+m},easeOutQuad:function(n,o,m,q,p){return -q*(o/=p)*(o-2)+m},easeInOutQuad:function(n,o,m,q,p){if((o/=p/2)<1){return q/2*o*o+m}return -q/2*((--o)*(o-2)-1)+m},easeInCubic:function(n,o,m,q,p){return q*(o/=p)*o*o+m},easeOutCubic:function(n,o,m,q,p){return q*((o=o/p-1)*o*o+1)+m},easeInOutCubic:function(n,o,m,q,p){if((o/=p/2)<1){return q/2*o*o*o+m}return q/2*((o-=2)*o*o+2)+m},easeInQuart:function(n,o,m,q,p){return q*(o/=p)*o*o*o+m},easeOutQuart:function(n,o,m,q,p){return -q*((o=o/p-1)*o*o*o-1)+m},easeInOutQuart:function(n,o,m,q,p){if((o/=p/2)<1){return q/2*o*o*o*o+m}return -q/2*((o-=2)*o*o*o-2)+m},easeInQuint:function(n,o,m,q,p){return q*(o/=p)*o*o*o*o+m},easeOutQuint:function(n,o,m,q,p){return q*((o=o/p-1)*o*o*o*o+1)+m},easeInOutQuint:function(n,o,m,q,p){if((o/=p/2)<1){return q/2*o*o*o*o*o+m}return q/2*((o-=2)*o*o*o*o+2)+m},easeInSine:function(n,o,m,q,p){return -q*Math.cos(o/p*(Math.PI/2))+q+m},easeOutSine:function(n,o,m,q,p){return q*Math.sin(o/p*(Math.PI/2))+m},easeInOutSine:function(n,o,m,q,p){return -q/2*(Math.cos(Math.PI*o/p)-1)+m},easeInExpo:function(n,o,m,q,p){return(o==0)?m:q*Math.pow(2,10*(o/p-1))+m},easeOutExpo:function(n,o,m,q,p){return(o==p)?m+q:q*(-Math.pow(2,-10*o/p)+1)+m},easeInOutExpo:function(n,o,m,q,p){if(o==0){return m}if(o==p){return m+q}if((o/=p/2)<1){return q/2*Math.pow(2,10*(o-1))+m}return q/2*(-Math.pow(2,-10*--o)+2)+m},easeInCirc:function(n,o,m,q,p){return -q*(Math.sqrt(1-(o/=p)*o)-1)+m},easeOutCirc:function(n,o,m,q,p){return q*Math.sqrt(1-(o=o/p-1)*o)+m},easeInOutCirc:function(n,o,m,q,p){if((o/=p/2)<1){return -q/2*(Math.sqrt(1-o*o)-1)+m}return q/2*(Math.sqrt(1-(o-=2)*o)+1)+m},easeInElastic:function(n,q,m,w,v){var r=1.70158;var u=0;var o=w;if(q==0){return m}if((q/=v)==1){return m+w}if(!u){u=v*0.3}if(o<Math.abs(w)){o=w;var r=u/4}else{var r=u/(2*Math.PI)*Math.asin(w/o)}return -(o*Math.pow(2,10*(q-=1))*Math.sin((q*v-r)*(2*Math.PI)/u))+m},easeOutElastic:function(n,q,m,w,v){var r=1.70158;var u=0;var o=w;if(q==0){return m}if((q/=v)==1){return m+w}if(!u){u=v*0.3}if(o<Math.abs(w)){o=w;var r=u/4}else{var r=u/(2*Math.PI)*Math.asin(w/o)}return o*Math.pow(2,-10*q)*Math.sin((q*v-r)*(2*Math.PI)/u)+w+m},easeInOutElastic:function(n,q,m,w,v){var r=1.70158;var u=0;var o=w;if(q==0){return m}if((q/=v/2)==2){return m+w}if(!u){u=v*(0.3*1.5)}if(o<Math.abs(w)){o=w;var r=u/4}else{var r=u/(2*Math.PI)*Math.asin(w/o)}if(q<1){return -0.5*(o*Math.pow(2,10*(q-=1))*Math.sin((q*v-r)*(2*Math.PI)/u))+m}return o*Math.pow(2,-10*(q-=1))*Math.sin((q*v-r)*(2*Math.PI)/u)*0.5+w+m},easeInBack:function(n,o,m,r,q,p){if(p==e){p=1.70158}return r*(o/=q)*o*((p+1)*o-p)+m},easeOutBack:function(n,o,m,r,q,p){if(p==e){p=1.70158}return r*((o=o/q-1)*o*((p+1)*o+p)+1)+m},easeInOutBack:function(n,o,m,r,q,p){if(p==e){p=1.70158}if((o/=q/2)<1){return r/2*(o*o*(((p*=(1.525))+1)*o-p))+m}return r/2*((o-=2)*o*(((p*=(1.525))+1)*o+p)+2)+m},easeInBounce:function(n,o,m,q,p){return q-h.easing.easeOutBounce(n,p-o,0,q,p)+m},easeOutBounce:function(n,o,m,q,p){if((o/=p)<(1/2.75)){return q*(7.5625*o*o)+m}else{if(o<(2/2.75)){return q*(7.5625*(o-=(1.5/2.75))*o+0.75)+m}else{if(o<(2.5/2.75)){return q*(7.5625*(o-=(2.25/2.75))*o+0.9375)+m}else{return q*(7.5625*(o-=(2.625/2.75))*o+0.984375)+m}}}},easeInOutBounce:function(n,o,m,q,p){if(o<p/2){return h.easing.easeInBounce(n,o*2,0,q,p)*0.5+m}return h.easing.easeOutBounce(n,o*2-p,0,q,p)*0.5+q*0.5+m}})})(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/lib/fastclick.js' */
var FastClick=(function(){var b="ontouchstart" in window;return function(n){if(!(n instanceof HTMLElement)){throw new TypeError("Layer must be instance of HTMLElement")}if(b){n.addEventListener("touchstart",l,true);n.addEventListener("touchmove",m,true);n.addEventListener("touchend",j,true);n.addEventListener("touchcancel",a,true)}n.addEventListener("click",k,true);if(n.onclick instanceof Function){n.addEventListener("click",n.onclick,false);n.onclick=""}var o={x:0,y:0,scroll:0},p=false;function l(c){p=true;o.x=c.targetTouches[0].clientX;o.y=c.targetTouches[0].clientY;o.scroll=window.pageYOffset;return true}function m(c){if(p){if(Math.abs(c.targetTouches[0].clientX-o.x)>10||Math.abs(c.targetTouches[0].clientY-o.y)>10){p=false}}return true}function j(c){var d,e;if(!p||Math.abs(window.pageYOffset-o.scroll)>5){return true}d=document.elementFromPoint(o.x,o.y);if(d.nodeType===Node.TEXT_NODE){d=d.parentNode}if(!(d.className.indexOf("clickevent")!==-1&&d.className.indexOf("touchandclickevent")===-1)){e=document.createEvent("MouseEvents");e.initMouseEvent("click",true,true,window,1,0,0,o.x,o.y,false,false,false,false,0,null);e.forwardedTouchEvent=true;d.dispatchEvent(e)}if(!(d instanceof HTMLSelectElement)&&d.className.indexOf("clickevent")===-1){c.preventDefault()}else{return false}}function a(c){p=false}function k(d){if(!window.event){return true}var c=true;var e;var f=window.event.forwardedTouchEvent;if(b){e=document.elementFromPoint(o.x,o.y);if(!e||(!f&&e.className.indexOf("clickevent")==-1)){c=false}}if(c){return true}d.stopPropagation();d.preventDefault();d.stopImmediatePropagation();return false}}})();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'templates/mywork.soy' */
// This file was automatically generated from mywork.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace MyWork.Templates.
 */

if (typeof MyWork == 'undefined') { var MyWork = {}; }
if (typeof MyWork.Templates == 'undefined') { MyWork.Templates = {}; }


MyWork.Templates.mainNotification = function(opt_data, opt_ignored) {
  return MyWork.Templates.mainNotificationHeader(null) + '<div class=\'mw-notifications-list\'>' + MyWork.Templates.loading(null) + '</div>' + MyWork.Templates.footer(null);
};
if (goog.DEBUG) {
  MyWork.Templates.mainNotification.soyTemplateName = 'MyWork.Templates.mainNotification';
}


MyWork.Templates.mainNotificationHeader = function(opt_data, opt_ignored) {
  return '<div class="mw-header aui-toolbar" data-role="header"><h2>' + soy.$$escapeHtml('\u901a\u77e5') + '</h2>' + MyWork.Templates.toggleButtons(null) + '</div>';
};
if (goog.DEBUG) {
  MyWork.Templates.mainNotificationHeader.soyTemplateName = 'MyWork.Templates.mainNotificationHeader';
}


MyWork.Templates.loading = function(opt_data, opt_ignored) {
  return '<div class=\'mw-loading\'>' + soy.$$escapeHtml('\u6b63\u5728\u52a0\u8f7d...') + '</div>';
};
if (goog.DEBUG) {
  MyWork.Templates.loading.soyTemplateName = 'MyWork.Templates.loading';
}


MyWork.Templates.footer = function(opt_data, opt_ignored) {
  return '<div class="mw-footer" data-role="footer"></div>';
};
if (goog.DEBUG) {
  MyWork.Templates.footer.soyTemplateName = 'MyWork.Templates.footer';
}


MyWork.Templates.toggleButtons = function(opt_data, opt_ignored) {
  return '<ul class="mw-toggles toolbar-group"><li class="toolbar-item"><a class="mw-button-notifications toolbar-trigger" title="' + soy.$$escapeHtml('\u901a\u77e5') + '"><span class="icon icon-notification"></span></a></li><li class="toolbar-item"><a class="toolbar-trigger mw-button-tasks" title="' + soy.$$escapeHtml('\u4e2a\u4eba\u4efb\u52a1') + '"><span class="icon icon-task"></span></a></li></ul>';
};
if (goog.DEBUG) {
  MyWork.Templates.toggleButtons.soyTemplateName = 'MyWork.Templates.toggleButtons';
}


MyWork.Templates.notificationDrilldown = function(opt_data, opt_ignored) {
  return '<div class="mw-drilldown-top" title="' + soy.$$escapeHtml('\u56de\u5230\u901a\u77e5\u5217\u8868 (\u952e\u5165 \x27u\x27)') + '"><a class="mw-drilldown-back"><span class="back-arrow"></span> ' + soy.$$escapeHtml('\u56de\u5230\u901a\u77e5\u5217\u8868') + '</a></div><div class="mw-drilldown-container"><div class="mw-drilldown-header"></div><div class="mw-drilldown-body"></div></div>';
};
if (goog.DEBUG) {
  MyWork.Templates.notificationDrilldown.soyTemplateName = 'MyWork.Templates.notificationDrilldown';
}


MyWork.Templates.drilldownEntry = function(opt_data, opt_ignored) {
  return '<div class="mw-drilldown-icon">' + ((opt_data.notification.iconUrl) ? '<img src="' + soy.$$escapeHtml(opt_data.notification.iconUrl) + '" class="mw-drilldown-avatar avatar">' : '') + '</div><div class="mw-drilldown-item"><div class="mw-drilldown-title">' + soy.$$filterNoAutoescape(opt_data.htmlTitle) + '</div>' + ((opt_data.notification.description) ? '<div class="mw-drilldown-excerpt">' + ((opt_data.notification.highlightTextHtml) ? '<blockquote><p>' + soy.$$escapeHtml(opt_data.notification.highlightTextHtml) + '</p></blockquote>' : '') + soy.$$filterNoAutoescape(opt_data.notification.descriptionHtml) + '</div>' : '') + '<div class="mw-drilldown-actions"><ul></ul><div class="message"></div><div class="action-form"></div></div></div>';
};
if (goog.DEBUG) {
  MyWork.Templates.drilldownEntry.soyTemplateName = 'MyWork.Templates.drilldownEntry';
}


MyWork.Templates.drilldownHeader = function(opt_data, opt_ignored) {
  return '<div class="drilldown-header-title"><div class="drilldown-title">' + ((opt_data.url) ? '<a href=' + soy.$$escapeHtml(opt_data.url) + ' target="_blank">' + soy.$$filterNoAutoescape(opt_data.title) + '</a>' : soy.$$escapeHtml(opt_data.title)) + '</div><div class="drilldown-new-actions">' + ((opt_data.displayIconClass) ? '<div class="drilldown-icon ' + soy.$$escapeHtml(opt_data.displayIconClass) + '"></div>' : (opt_data.displayIconUrl) ? '<img class="drilldown-icon" src="' + soy.$$escapeHtml(opt_data.displayIconUrl) + '">' : '') + '<span class="drilldown-action-text">' + soy.$$escapeHtml(opt_data.newActionsText) + '</span></div><div class="mw-drilldown-actions"><ul></ul><div class="message"></div></div><div class="action-form"></div></div>';
};
if (goog.DEBUG) {
  MyWork.Templates.drilldownHeader.soyTemplateName = 'MyWork.Templates.drilldownHeader';
}


MyWork.Templates.notificationView = function(opt_data, opt_ignored) {
  return '<div class="mw-notification-verb-icon">' + ((opt_data.notification.displayIconClass) ? '<div class="' + soy.$$escapeHtml(opt_data.notification.displayIconClass) + '"></div>' : (opt_data.notification.displayIconUrl) ? '<div style="background:url(' + soy.$$escapeHtml(opt_data.notification.displayIconUrl) + ') no-repeat 0 0; width:16px; height:16px"></div>' : '') + '</div><div class="mw-notification-text"></div><div class="mw-notification-time" title="' + soy.$$escapeHtml(opt_data.prettyTime) + '">' + soy.$$escapeHtml(opt_data.prettyTime) + '</div><div class="mw-drilldown-arrow"></div>';
};
if (goog.DEBUG) {
  MyWork.Templates.notificationView.soyTemplateName = 'MyWork.Templates.notificationView';
}


MyWork.Templates.mainTasks = function(opt_data, opt_ignored) {
  return MyWork.Templates.taskHeader(opt_data) + '<ul class="mw-tasks-list">' + MyWork.Templates.loading(null) + '</ul><div class="mw-footer" data-role="footer"><a class="view-completed">' + soy.$$escapeHtml('\u67e5\u770b\u5b8c\u6210\u7684') + '</a></div>';
};
if (goog.DEBUG) {
  MyWork.Templates.mainTasks.soyTemplateName = 'MyWork.Templates.mainTasks';
}


MyWork.Templates.deprecatedTasks = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return MyWork.Templates.deprecatedTaskHeader(opt_data) + '<div class="mw-deprecated-tasks"><div class="mw-deprecated-task-content"><div class="mw-deprecated-task-banner"><div class="mw-deprecated-task-sign"><div class="mw-deprecated-task-sign-holder"></div><div class="mw-deprecated-task-sign-box">' + soy.$$escapeHtml('\u6211\u4eec\u642c\u5bb6\u4e86') + '</div></div></div><div class="subheading"><h3>' + soy.$$escapeHtml('\u4efb\u52a1\u6709\u4e86\u4e00\u4e2a\u65b0\u5bb6') + '</h3></div><p>' + soy.$$escapeHtml('\u6211\u4eec\u5df2\u7ecf\u521b\u5efa\u4e86\u65b0\u7684\u5730\u65b9\uff0c\u60a8\u53ef\u5728\u90a3\u770b\u5230\u6240\u6709\u5206\u914d\u7ed9\u60a8\u7684\u6216\u7531\u60a8\u521b\u5efa\u7684\u4efb\u52a1\u3002') + '</p>' + ((opt_data.userMustMigrate) ? '<p>' + soy.$$escapeHtml('To help you transition to the new tasks we\x27ve just sent your existing personal tasks to your email address.') + '</p>' : '') + '</div><ul class="mw-deprecated-task-controls"><li><button id="mw-deprecated-task-show-me" class="aui-button-primary aui-button aui-style">' + soy.$$escapeHtml('\u663e\u793a\u81ea\u5df1') + '</button></li><li><a id="mw-deprecated-task-dissmiss" href="#">' + soy.$$escapeHtml('Ok\uff0c\u77e5\u9053\u4e86\uff01') + '</a></li></ul></div><div class="mw-footer" data-role="footer"></div>';
};
if (goog.DEBUG) {
  MyWork.Templates.deprecatedTasks.soyTemplateName = 'MyWork.Templates.deprecatedTasks';
}


MyWork.Templates.taskHeader = function(opt_data, opt_ignored) {
  return '<div class="mw-header aui-toolbar" data-role="header"><h2>' + soy.$$escapeHtml('\u4e2a\u4eba\u4efb\u52a1') + '</h2>' + MyWork.Templates.toggleButtons(null) + '<div class="add-task-row"><button class="add-task aui-button aui-style">' + soy.$$escapeHtml(opt_data.addTaskButtonText) + '</button><div><input id="new-personal-task" type="text" placeholder="' + soy.$$escapeHtml(opt_data.addTaskPlaceholder) + '"/></div></div></div>';
};
if (goog.DEBUG) {
  MyWork.Templates.taskHeader.soyTemplateName = 'MyWork.Templates.taskHeader';
}


MyWork.Templates.deprecatedTaskHeader = function(opt_data, opt_ignored) {
  return '<div class="mw-header aui-toolbar" data-role="header"><h2>' + soy.$$escapeHtml('\u4e2a\u4eba\u4efb\u52a1') + '</h2>' + MyWork.Templates.toggleButtons(null) + '</div>';
};
if (goog.DEBUG) {
  MyWork.Templates.deprecatedTaskHeader.soyTemplateName = 'MyWork.Templates.deprecatedTaskHeader';
}


MyWork.Templates.personalTask = function(opt_data, opt_ignored) {
  return '<div class="entire-task notes"><div class="handle"></div><div class="spacer"></div><div class="mw-task-checkbox-w"><div class="mw-task-checkbox"></div></div><div class="spacer"></div><div class="item-content notes">' + soy.$$escapeHtml(opt_data.text) + '</div>' + ((opt_data.task.item.url) ? (opt_data.task.item.displayIconClass) ? '<a href="' + soy.$$escapeHtml(opt_data.task.item.url) + '" title="' + soy.$$escapeHtml(opt_data.task.item.title) + '" class="' + soy.$$escapeHtml(opt_data.task.item.displayIconClass) + ' mw-task-link" target="_blank"></a>' : '<a href="' + soy.$$escapeHtml(opt_data.task.item.url) + '" title="' + soy.$$escapeHtml(opt_data.task.item.title) + '" class="mw-task-link" target="_blank" style="background-image:url(' + soy.$$escapeHtml(opt_data.task.item.displayIconUrl) + ')"></a>' : '') + '<div class="mw-drilldown-arrow"></div></div>';
};
if (goog.DEBUG) {
  MyWork.Templates.personalTask.soyTemplateName = 'MyWork.Templates.personalTask';
}


MyWork.Templates.personalTaskDetail = function(opt_data, opt_ignored) {
  return '<div class="mw-drilldown-top" title="' + soy.$$escapeHtml(opt_data.backToTasksText) + '"><a class="mw-taskdetail-back"><span class="back-arrow"></span> ' + soy.$$escapeHtml(opt_data.backToTasksText) + '</a></div><div class="mw-taskdetail-outer-container"><div class="mw-taskdetail-header"><span class="mw-task-checkbox-w"><a class="mw-task-checkbox" tabindex="1"></a></span>' + ((opt_data.task.readonlyTitle) ? '<a class="mw-taskdetail-title" href="' + soy.$$escapeHtml(opt_data.task.item.url) + '" target="_blank" tabindex="2">' + soy.$$escapeHtml(opt_data.task.title) + '</a>' : '<input type="text" class="mw-taskdetail-title" value="' + soy.$$escapeHtml(opt_data.task.title) + '" tabindex="2"/>') + '</div><div class="mw-taskdetail-container">' + MyWork.Templates.taskDetailBody(opt_data) + MyWork.Templates.taskDetailDelete(null) + '</div></div>';
};
if (goog.DEBUG) {
  MyWork.Templates.personalTaskDetail.soyTemplateName = 'MyWork.Templates.personalTaskDetail';
}


MyWork.Templates.taskDetailBody = function(opt_data, opt_ignored) {
  return '<div tabindex="3" class="mw-taskdetail-notes ' + ((opt_data.task.item.url) ? 'short' : '') + '" ></div><textarea tabindex="3" class="mw-taskdetail-notes-textarea ' + ((opt_data.task.item.url) ? 'short' : '') + '"></textarea>' + ((opt_data.task.item.url) ? '<div class="mw-related-content">' + ((opt_data.task.item.displayIconClass) ? '<div type="text" class="' + soy.$$escapeHtml(opt_data.task.item.displayIconClass) + ' mw-related-title">' : '<div type="text" class="mw-related-title" style="background:url(' + soy.$$escapeHtml(opt_data.task.item.displayIconUrl) + ') no-repeat 0 0;">') + '<a href="' + soy.$$escapeHtml(opt_data.task.item.url) + '" target="_blank">' + soy.$$escapeHtml(opt_data.task.item.title) + '</a></div></div>' : '');
};
if (goog.DEBUG) {
  MyWork.Templates.taskDetailBody.soyTemplateName = 'MyWork.Templates.taskDetailBody';
}


MyWork.Templates.taskDetailTags = function(opt_data, opt_ignored) {
  return '<div class="mw-taskdetail-tags"><h1>' + soy.$$escapeHtml('\u6807\u7b7e') + '</h1><div class="mw-taskdetail-taglist"></div></div>';
};
if (goog.DEBUG) {
  MyWork.Templates.taskDetailTags.soyTemplateName = 'MyWork.Templates.taskDetailTags';
}


MyWork.Templates.taskDetailDelete = function(opt_data, opt_ignored) {
  return '<div class="mw-taskdetail-action-buttons"><button tabindex="4" class="mw-taskdetail-save aui-button aui-button-primary">' + soy.$$escapeHtml('\u4fdd\u5b58') + '</button><button tabindex="5" class="mw-taskdetail-delete aui-button">' + soy.$$escapeHtml('\u5220\u9664') + '</button></div>';
};
if (goog.DEBUG) {
  MyWork.Templates.taskDetailDelete.soyTemplateName = 'MyWork.Templates.taskDetailDelete';
}


MyWork.Templates.noNotifications = function(opt_data, opt_ignored) {
  return '<div class="mw-no-notifications"><h1>' + soy.$$escapeHtml(opt_data.heading) + '</h1><div class="subheading"><p>' + soy.$$escapeHtml(opt_data.subheading) + '</p></div>' + soy.$$escapeHtml(opt_data.body) + '</div>';
};
if (goog.DEBUG) {
  MyWork.Templates.noNotifications.soyTemplateName = 'MyWork.Templates.noNotifications';
}


MyWork.Templates.noTasks = function(opt_data, opt_ignored) {
  return '<div class="mw-no-tasks"><div class="taskarrow-callout"></div><li class="empty-task"><div class="entire-task empty"><p>' + soy.$$escapeHtml(opt_data.noTaskItem) + '</p></div></li><p>' + soy.$$escapeHtml(opt_data.noTaskDescription) + '</p><div class="list-container"><div><ul><li>' + soy.$$escapeHtml(opt_data.noTask1) + '</li><li>' + soy.$$escapeHtml(opt_data.noTask2) + '</li></ul></div><div class="addtask-callout-container"><div class="addtask-callout"></div></div></div><div class="list-container"><div class="task-callout-list"><ul><li>' + soy.$$escapeHtml(opt_data.noTask3) + '</li></ul></div><div class="task-callout-container"><div class="task-callout"></div></div></div>';
};
if (goog.DEBUG) {
  MyWork.Templates.noTasks.soyTemplateName = 'MyWork.Templates.noTasks';
}


MyWork.Templates.showMore = function(opt_data, opt_ignored) {
  return '<li class="mw-mobile-entry-item more-trigger"><a href="#" class="mw-show-more button gradient-background">' + soy.$$escapeHtml('\u66f4\u591a') + '</a></li>';
};
if (goog.DEBUG) {
  MyWork.Templates.showMore.soyTemplateName = 'MyWork.Templates.showMore';
}


MyWork.Templates.completedCategory = function(opt_data, opt_ignored) {
  return '<li class=\'task completed category\'>' + soy.$$escapeHtml(opt_data.category) + '</li>';
};
if (goog.DEBUG) {
  MyWork.Templates.completedCategory.soyTemplateName = 'MyWork.Templates.completedCategory';
}


MyWork.Templates.openLinkAction = function(opt_data, opt_ignored) {
  return '<a target="' + soy.$$escapeHtml(opt_data.notification.target) + '" href="' + soy.$$escapeHtml(opt_data.url) + '" data-url="' + soy.$$escapeHtml(opt_data.notification.parent.url) + '">' + soy.$$escapeHtml(opt_data.displayName) + '</a>';
};
if (goog.DEBUG) {
  MyWork.Templates.openLinkAction.soyTemplateName = 'MyWork.Templates.openLinkAction';
}


MyWork.Templates.inlineActionForm = function(opt_data, opt_ignored) {
  return '<form class="inline-action-form"></form>';
};
if (goog.DEBUG) {
  MyWork.Templates.inlineActionForm.soyTemplateName = 'MyWork.Templates.inlineActionForm';
}


MyWork.Templates.inlineActionTextarea = function(opt_data, opt_ignored) {
  return '<div class="expandingArea"><pre><span></span><br></pre><textarea class="mw-inline-textarea" name="comment" rows="3"></textarea></div>';
};
if (goog.DEBUG) {
  MyWork.Templates.inlineActionTextarea.soyTemplateName = 'MyWork.Templates.inlineActionTextarea';
}


MyWork.Templates.inlineActionSubmit = function(opt_data, opt_ignored) {
  return '<div class="inline-action-submit"><button class="aui-button aui-button-primary add-comment-button disabled">' + soy.$$escapeHtml(opt_data.submitLabel) + '</button><button class="aui-button inline-cancel">' + soy.$$escapeHtml('\u53d6\u6d88') + '</button></div>';
};
if (goog.DEBUG) {
  MyWork.Templates.inlineActionSubmit.soyTemplateName = 'MyWork.Templates.inlineActionSubmit';
}


MyWork.Templates.categoryLabel = function(opt_data, opt_ignored) {
  return '<span class="category-label">' + soy.$$escapeHtml(opt_data.text) + '</span>';
};
if (goog.DEBUG) {
  MyWork.Templates.categoryLabel.soyTemplateName = 'MyWork.Templates.categoryLabel';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/models/configuration-model.js' */
(function(){function a(){return Array.prototype.slice.apply(arguments).join(".")}MW.Configuration=Backbone.Model.extend({parse:function(b){b.objectActions={};b.itemActions={};b.taskActions={};var c=function(f,e,d){_(e).map(function(g){f[g]=(f[g]||[]).concat([d])})};_(b.actions).each(function(d,e){d.id=e;c(b.objectActions,d.objectActions,d);c(b.itemActions,d.actions,d);c(b.taskActions,d.taskActions,d);d.attrs=d.attrs||{};d.attrs.getAlternateAction=function(){return b.actions[d.attrs.alternateAction]}});return b},appendUrl:function(b){var c=this.getProperty(b);return c?this.getUrl()+c:c},getUrl:function(){return this.get("url")||""},getProperty:function(){var b=a.apply(this,arguments);return this.get("properties")[b]||""},getUserUrl:function(b,c){return(this.get("url")||"")+MW.formatString(this.getProperty(b+".user_url"),{username:encodeURIComponent(c)})},getObjectActions:function(b,d,c){return this.getMyActions(this.get("objectActions"),b,d,c)},getActions:function(b,d,c){return this.getMyActions(this.get("itemActions"),b,d,c)},getTaskActions:function(b,d,c){return this.getMyActions(this.get("taskActions"),b,d,c)},getMyActions:function(e,b,d,c){e=e||{};c=c||{};var f;if(d==="invite"){f=[].concat(e[b+"."+d]||[])}else{f=[].concat(e[b]||[],e[b+"."+d]||[])}return _(f).filter(_.bind(function(g){return this.isMetadataMatch(c,g.attrs.condition||{})},this))},isMetadataMatch:function(b,c){return _.all(c,function(e,d){return b[d]==e})},i18n:function(b){return this.get("i18n")[b]}})})();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/models/task-model.js' */
MW.Task=Backbone.Model.extend({setState:function(a){if(this.config.getTaskActions(this.get("entity"),this.get("action")).length>0){MW.$.ajax({type:"POST",url:MW.contextPath+"/rest/mywork/1/action/task",dataType:"json",contentType:"application/json",data:JSON.stringify({application:this.get("application"),qualifiedAction:this.get("category"),id:this.get("id"),status:a,metadata:this.get("metadata")})})}this.save({status:a});MW.Notifications.setStatusByGlobalId(this.get("globalId"),a)},reorder:function(b){var a=this;MW.$.ajax({url:MW.contextPath+"/rest/mywork/latest/task/"+a.get("id")+"/position",type:"PUT",contentType:"application/json",data:JSON.stringify({before:b})})},initialize:function(){this.parse(this.attributes)},parse:function(a){if(!a.item){a.item={}}var c=a.item,d=MW.Configurations.hasConfig(a),b=this.config=MW.Configurations.getFromNotification(a);a.title=a.title||c.title;a.category=a.application+"."+a.entity;if(d){if(c){if(c.url&&c.url.indexOf("/")===0){c.url=b.get("url")+c.url}if(c.iconUrl&&c.iconUrl.indexOf("/")===0){c.iconUrl=b.get("url")+c.iconUrl}}}c.displayIconUrl=c.iconUrl||this.config.appendUrl(a.category);if(this.hasDisplayIconClass(a.entity)){c.displayIconClass="mw-icon-"+a.entity}a.readonlyTitle=this.config.getProperty(a.category,"readonlyTitle")=="true";return a},hasDisplayIconClass:function(a){return _.include(["blog","page","comment","inline-task"],a)},setTitle:function(a){if(this.get("title")!=a){this.save({title:a})}},setNotes:function(a){var b=this;if(this.get("notes")!=a){MW.$.ajax({url:MW.contextPath+"/rest/mywork/latest/task/"+b.get("id")+"/notes",type:"PUT",contentType:"application/json",data:JSON.stringify(a)});this.set({notes:a})}},isCompleted:function(){return this.get("status")==="DONE"}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/models/notification-model.js' */
AJS.EventQueue=AJS.EventQueue||[];MW.Notification=Backbone.Model.extend({getPrettyTime:function(){return MW.getPrettyTime(this.get("created"))},open:function(){this.get("parent").trigger("open",this);window.open(this.attributes.url)},toEventJSON:function(){return _.extend(MW.pick(this.attributes,"id","globalId","status"),MW.pick(this.get("parent").attributes,"application","entity","action"))},executeInlineAction:function(b){var a=this.getActionData(b.actionName,b.target);var c=b.extraData?_.extend(b.extraData,a):a;MW.$.ajax({type:"POST",url:MW.contextPath+"/rest/mywork/1/action",data:JSON.stringify(c),dataType:"json",success:b.success,error:b.error,contentType:"application/json"})},getActionData:function(a,b){return{globalId:this.get("globalId"),qualifiedAction:this.get("parent").get("category")+"."+a,application:this.get("parent").get("application"),metadata:this.get("metadata"),target:b,id:this.get("id")}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/models/notification-group-model.js' */
AJS.EventQueue=AJS.EventQueue||[];MW.NotificationGroup=Backbone.Model.extend({initialize:function(d,b){var a=this.globalEvents=b.globalEvents;this.config=b.config;var c=this;this.notifications=[];if(a){a.on("focusClickedNotification",this.focusSelected,this);a.on("removeDrilldownFocused",function(){if(c.get("drilldownFocused")){c.set("drilldownFocused",false)}});a.on("removeMainFocused",function(){if(c.get("mainFocused")){c.set("mainFocused",false)}})}},setState:function(a,d){var b=this;this.set("status",a);var c=this.notifications[0].get("id");MW.$.ajax({url:MW.contextPath+"/rest/mywork/latest/notification/"+c+"/status",type:"PUT",contentType:"application/json",data:JSON.stringify(a),success:function(e){d&&d();if(!_.isObject(e)){e=JSON.parse(e)}MW.Tasks.getByGlobalIdDeferred(e.globalId,function(f){if(f&&f.isCompleted()){f.set("globalId","",{silent:true})}});MW.Tasks.add(e,{at:0})}})},hasTask:function(){return this.get("status")==="TODO"},createTask:function(b){this.setState("TODO",b);var a=this.get("globalId");MW.Notifications.setStatusByGlobalId(a,"TODO");this.globalEvents.trigger("taskCreated");AJS.EventQueue.push({name:"mywork.createTask",properties:{changeStatusTo:this.get("status")}})},appendNotifications:function(a){var b=this;a=_.map(a,function(d){var c=MW.$.extend(d,{globalEvents:b.globalEvents,parent:b});return new MW.Notification(c)});this.notifications=_.sortBy(a.concat(this.notifications),function(c){return c.get("created")*-1});this.updateStatus();this.set("notifications",this.notifications);this.set("updated",_.first(this.notifications).get("created"));this.trigger("modified",this);this.globalEvents.trigger("removeDrilldownFocused")},getPrettyTime:function(){return MW.getPrettyTime(_.first(this.notifications).get("created"))},getUnreadNotifications:function(){return _.filter(this.get("notifications"),function(a){return !a.get("read")})},getMetadata:function(){return this.notifications[0].get("metadata")},resetFocused:function(a){this.removeFocus();(a||_.first(this.notifications)).set("drilldownFocused",true,{silent:true})},updateStatus:function(){var a=this.notifications[0].get("globalId");if(!_.any(this.notifications,function(b){return b.get("globalId")!==a})){this.set("globalId",this.notifications[0].get("globalId"));this.set("status",this.notifications[0].get("status"))}else{this.unset("globalId");this.unset("status")}},setStatusByGlobalId:function(b,a){if(this.get("globalId")===b){this.set("status",a);_.each(this.notifications,function(c){c.set("status",a)})}else{_.each(this.notifications,function(c){if(c.get("globalId")===b){c.set("status",a)}})}},hasNewNotifications:function(){return !(this.notifications)[0].get("read")},i18ns:function(a,c){var b=c>1?"s":"";return this.i18n.apply(this,[a+b].concat(Array.prototype.slice.call(arguments,1)))},i18n:function(a){var b={};_.each(Array.prototype.slice.call(arguments,1),function(c,d){b[d]=c});return this.i18nWithMap(a,b)},i18nWithMap:function(a,b){return this.entityI18n(this.get("action")+(a?"."+a:""),b)},i18nHtml:function(a,f){var e=MW.escapeHTML(this.i18nWithMap(a,MW.$.extend({user:"{user}"},f)));if(!e){return""}var d=this.getMetadata();var c=this.config.getUserUrl(this.get("application"),d.username);var b=d.user||"";var g=c?MW.$("<a />").attr("target","_blank").attr("href",c).text(b).wrap("<div />").parent().html():MW.escapeHTML(b);return e.replace("{user}",g)},entityI18n:function(a,d){var b=this.get("category")+(a?"."+a:""),c=this.config.i18n(b);if(!c){return""}return MW.formatString(c,_.extend({},this.getMetadata(),d))},focused:function(){for(var a=0;a<this.notifications.length;a++){if(!!this.notifications[a].get("drilldownFocused")){return this.notifications[a]}}},focusOlder:function(){var b=_.indexOf(this.notifications,this.focused());var a=this.notifications[Math.min(this.notifications.length-1,b+1)];if(!a.get("drilldownFocused")){this.removeFocus();a.set("drilldownFocused",true)}return a},focusNewer:function(){var a=_.indexOf(this.notifications,this.focused());if(a>0){this.removeFocus();this.notifications[a-1].set("drilldownFocused",true)}},focusSelected:function(b){var a=this.focused();if(a&&a!==b){this.removeFocus();b.set("drilldownFocused",true)}},focusOldest:function(){this.removeFocus();_.last(this.notifications).set("drilldownFocused",true)},removeFocus:function(){_.each(this.notifications,function(a){a.set("drilldownFocused",false)})}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/collections/configuration-collection.js' */
MW.ConfigurationCollection=Backbone.Collection.extend({initialize:function(a){this.model=MW.Configuration;this.url=MW.contextPath+"/rest/mywork/latest/configuration";this.blank=new MW.Configuration({i18n:{},properties:{}})},fetchOnce:_.once(function(){var a=MW.$.Deferred();this.fetch({success:function(){a.resolve()},data:{version:MW.configurationVersion}});return a}),getFromNotificationRaw:function(a){return this.find(function(b){return(a.applicationLinkId||"")===b.get("appId")&&a.application==b.get("application")})},getFromNotification:function(a){return this.getFromNotificationRaw(a)||this.blank},hasConfig:function(a){return typeof this.getFromNotificationRaw(a)!=="undefined"}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/collections/task-collection.js' */
MW.TaskCollection=Backbone.Collection.extend({all:function(){return this.filter(function(a){return true})},initialize:function(){this.model=MW.Task;this.url=MW.contextPath+"/rest/mywork/latest/task";this.hasFetched=MW.Deferred()},fetchOnce:_.once(function(a){this.fetcher(a)}),fetcher:function(a){this.fetch(this.hasFetched.resolveOnSuccess(_.extend({add:true,data:{type:"inline_task"}},a)))},reorder:function(a,c){var b,d;if(c){b=this.indexOf(c);d=c.get("id")}else{b=this.length}this.remove(a);this.add(a,{at:b});a.reorder(d)},getByIdDeferred:function(c,b){var a=this;this.hasFetched.done(function(){b(a.get(c))})},getByGlobalIdCheckHost:function(c,b){var a=this;this.getByGlobalIdDeferred(c,function(d){if(d){b(d)}else{a.fetcher({add:false,success:function(){a.getByGlobalIdDeferred(c,b)}})}})},getByGlobalIdDeferred:function(c,b){var a=this;this.hasFetched.done(function(){b(a.getByGlobalId(c))})},getByGlobalId:function(a){return this.find(function(b){return(b.get("globalId")===a)})},todo:function(){return this.filter(function(a){return !a.isCompleted()})},done:function(){return this.doneBetween()},doneOlderThan:function(a){return this.doneBetween(a)},doneNewerThan:function(a){return this.doneBetween(null,a)},doneBetween:function(b,a){return this.filter(function(c){var d=new Date(c.get("updated"));var e;if(!b&&!a){e=true}else{if(!a){e=d<b}else{if(!b){e=d>=a}else{e=(d>=b&&d<a)}}}if(e){return c.isCompleted()}})},parse:function(a){var b=this;_.each(a,function(c){c.displayName=c.item.title||""});setTimeout(function(){b.trigger("fetch")});return a}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/collections/notification-collection.js' */
MW.NotificationCollection=Backbone.Collection.extend({currentLastFetchId:0,beforeId:0,fetcher:function(a){a=a||{};if(!this.firstFetch&&a.updateOnly){return}if(!this.firstFetch){this.firstFetch=true;return this.fetchWithLimit(this.hasFetched.resolveOnSuccess(a))}else{return this.fetchAfterWithLimit(a)}},fetchWithLimit:function(a){a.data=a.data||{};a.data=_.extend(a.data,{limit:MW.MAX_RESULTS});return this.fetch(a)},fetchAfterWithLimit:function(a){a=_.extend(a,{add:true});a.data=a.data||{};a.data=_.extend(a.data,{after:this.currentLastFetchId});return this.fetchWithLimit(a)},initialize:function(b,a){var c=this;this.globalEvents=a.globalEvents;this.url=MW.contextPath+"/rest/mywork/latest/notification/nested";this.model=MW.NotificationGroup;this.hasFetched=MW.Deferred();this.config=a.config},comparator:function(d,b){var e=d.attributes.pinned,c=b.attributes.pinned;if(e&&!c){return -1}if(!e&&c){return 1}var a=d.attributes.updated,f=b.attributes.updated;if(a<f){return 1}if(a>f){return -1}return 0},setLastReadId:function(a){if(a<=this.currentLastFetchId){return}this.currentLastFetchId=a;MW.$.ajax({url:MW.contextPath+"/rest/mywork/latest/notification/lastreadid",type:"PUT",contentType:"application/json",data:JSON.stringify(this.currentLastFetchId)})},getCategory:function(a){return a.application+"."+a.entity},geti18nKey:function(a){return this.getCategory(a)+"."+a.action},isMyWorkAuth:function(a){return a.application=="com.atlassian.mywork.host.provider"&&a.entity=="authentication"},prepareMyWorkAuth:function(b,a,c){var d=MW.createCallback(c);if(d){_.each(a,function(e){e.url+=MW.appendCallback(e.url,d);e.target="_top"});b.url=a[0].url;b.target="_top"}},parse:function(b){var d=this;var c=[];_.each(b,function(g){var f=d.initNotification(g);c=c.concat(f)});if(!this.currentLastFetchId&&!!c.length){c[0].mainFocused=true}var e=0;var a=[];_(c).each(function(h){_(h.notifications).each(function(i){if(i.id>e){e=i.id}d.beforeId=i.id});var f=d.getByAggregateKey(h.aggregateKey);if(f){return f.appendNotifications(h.notifications)}var g=new MW.NotificationGroup(h,{globalEvents:d.globalEvents,config:d.config.getFromNotification(h)});g.appendNotifications(h.notifications);a.push(g)});this.setLastReadId(e||this.currentLastFetchId);return a},initNotification:function(f){var e=this,d=f.item,c=f.notifications,g=this.config.hasConfig(d),a=this.config.getFromNotification(d),b=this.geti18nKey(d);if(this.isBasicAction(d)){d.displayIconClass="mw-icon-"+this.getIconClassName(d)}d.category=e.getCategory(d);if(g){d.objectActions=a.getObjectActions(d.entity,d.action,c[0].metadata);if(d.url&&d.url.indexOf("/")===0){d.url=a.get("url")+d.url}if(d.iconUrl&&d.iconUrl.indexOf("/")===0){d.iconUrl=a.get("url")+d.iconUrl}}else{if(d.url){d.objectActions=[{type:"link"}]}else{d.objectActions=[]}}d.notifications=[];if(this.isMyWorkAuth(d)){this.prepareMyWorkAuth(d,c,MW.getBaseUrl())}_.each(c,function(h){h.target=h.target||"_blank";h.descriptionHtml=(h.description||"");h.highlightTextHtml=h.metadata&&h.metadata.highlightText;var i=_(["br","ul","p"]).chain().map(function(j){return h.descriptionHtml.indexOf("<"+j)>=0}).any().value();if(!i){h.descriptionHtml=h.descriptionHtml.replace(/\n/g,"<br/>")}if(g){h.actions=a.getActions(d.entity,d.action,h.metadata);if(h.url&&h.url.indexOf("/")===0){h.url=a.get("url")+h.url}if(h.iconUrl&&h.iconUrl.indexOf("/")===0){h.iconUrl=a.get("url")+h.iconUrl}if(h.actionIconUrl&&h.actionIconUrl.indexOf("/")===0){h.actionIconUrl=a.get("url")+h.actionIconUrl}}else{if(h.url){h.actions=[{type:"link"}]}else{h.actions=[]}}d.notifications.push(h)});d.displayIconUrl=c[0].actionIconUrl||d.iconUrl||a.appendUrl(b)||a.appendUrl(d.category);return d},isBasicAction:function(a){if(a.application==="com.atlassian.mywork.providers.jira"){return a.action==="comment"}else{if(a.application==="com.atlassian.mywork.providers.confluence"){return _.include(["like","comment","task.assign","mentions.user","share","resolve","reopen","invite"],a.action)}}return false},getIconClassName:function(a){var b=a.action;if(b.indexOf("task")!==-1){b="inline-task"}if(_.include(["mentions.user","share","invite"],b)){b=a.entity}return b},main:function(){return this.models},unread:function(){return this.filter(function(a){return !a.get("read")})},setNotificationsAsRead:function(a,c){var b=_(a).chain().filter(function(d){return !d.get("read")}).map(function(d){d.set("read",true,{silent:c});return d.id}).value();if(b.length>0){MW.$.ajax({url:MW.contextPath+"/rest/mywork/latest/notification/read",type:"PUT",contentType:"application/json",data:JSON.stringify(b)})}},getByAggregateKeyDeferred:function(a,c){var b=this;this.hasFetched.done(function(){c(b.getByAggregateKey(a))})},getByAggregateKey:function(a){return this.find(function(b){return b.get("aggregateKey")===a})},setStatusByGlobalId:function(b,a){this.each(function(c){c.setStatusByGlobalId(b,a)})},drilldown:function(a){return this.filter(function(b){return(b.get("aggregateKey")==a)})},focused:function(a){return this.find(function(b){return(b.get(a))})},focusMain:function(e,b){var d=this.main(b),a="removeMainFocused",c="mainFocused";return("up"==e)?this.focusPrevious(d,c,a):this.focusNext(d,c,a)},setFocused:function(a){this.globalEvents.trigger("removeMainFocused");a.set("mainFocused",true)},focusNext:function(d,b,a){var c=_.indexOf(d,this.focused(b));if(c<(d.length-1)){if(a){this.globalEvents.trigger(a)}else{currentView[c].set(b,false)}d[c+1].set(b,true);return true}else{return false}},focusPrevious:function(d,b,a){var c=_.indexOf(d,this.focused(b));if(c>0){if(a){this.globalEvents.trigger(a)}else{d[c].set(b,false)}d[c-1].set(b,true);return true}return false},countNested:function(a){var b=0;_(a).each(function(c){b+=c.get("notifications").length});return b}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/views/task-view.js' */
MW.TaskAbstractView=Backbone.View.extend({tagName:"li",className:"task",events:{"click .item-content":"showDetail","click .mw-task-text":"showDetail","click .mw-drilldown-arrow":"showDetail","click .mw-task-checkbox":"toggleStatus"},initialize:function(a){this.globalEvents=a.globalEvents;this.model.bind("change",this.render,this);a.globalEvents.bind("reordered",this.reordered,this)},showDetail:function(){this.globalEvents.trigger("showTaskDetail",this.model)},toggleStatus:function(){if(!this.model.isCompleted()){this.model.setState("DONE")}else{this.model.setState("TODO")}},reordered:function(d,c){if(this.model.cid===d){var a=this.model;var b=MW.Tasks.getByCid(c);MW.Tasks.reorder(a,b)}},getDisplayText:function(){var a=this.model.get("title");if(!a){a=""}return a},render:function(){var a=this.$el,d=this.getDisplayText(),c=/(^|\s)#(\w+)/g,b=d.match(c);d=this.parseTagText(d,c);this.renderTemplate(a,d);this.renderTagLozenge(b);if(this.model.isCompleted()){a.addClass("completed")}else{a.removeClass("completed")}return this}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/views/notification-view.js' */
MW.NotificationAbstractView=Backbone.View.extend({tagName:"li",className:"mw-notification-item",events:{click:"renderDrilldownClick"},initialize:function(a){var b=this;this.globalEvents=a.globalEvents;this.globalEvents.bind("renderDrilldown",this.renderSpecifiedDrilldown,this);this.model.bind("change",this.render,this);_.bindAll(this,"renderSpecifiedDrilldown")},render:function(){var a=MW.$(this.el);a.toggleClass("unread",this.model.hasNewNotifications());a.toggleClass("focused",this.model.get("mainFocused")||false);if(this.model.get("pinned")){a.addClass("pinned")}this.renderTemplate(a);this.updateTitle();return this},renderDrilldownClick:function(){this.globalEvents.trigger("renderDrilldown",this.model,false)},renderSpecifiedDrilldown:function(b,a,c){if(this.model.get("aggregateKey")==b.get("aggregateKey")){this.renderDrilldown(a,c)}},renderDrilldown:function(b,d){var c=this,a=new MW.DrilldownView({model:this.model,globalEvents:c.globalEvents,reverseSlide:d});this.model.resetFocused(_(this.model.getUnreadNotifications()).last());this.renderDrilldownTemplate(a,b);this.globalEvents.trigger("removeMainFocused");this.model.set("mainFocused",true);MW.Notifications.setNotificationsAsRead(this.model.notifications,true);this.updateTitle();this.$el.removeClass("unread")},updateTitle:function(){var d=this.$el.find(".mw-notification-text");var c=this.model.notifications,f=this.model;var a=_.filter(c,function(g){return !g.get("read")}).length;var e="",b=this.model.get("title")||c[0].get("title")||"";if(c.length===1){e=f.i18nWithMap("title",{title:b})}else{e=f.i18ns("aggregate",c.length,b);if(a){e=f.i18ns("aggregatenew",a,b)||e}}d.text(e||b).attr("title",e)}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/views/notification-main-view.js' */
MW.NotificationMainAbstractView=Backbone.View.extend({className:"mw-notifications card",events:{"click .mw-show-more":"showMoreNotificationsEvent","click .mw-button-tasks":"gotoTasks"},initialize:function(a){this.globalEvents=a.globalEvents;this.globalEvents.on("showNotificationCard",this.showCard,this);this.globalEvents.bind("highlightNotificationAbove",this.highlightNotificationAbove,this);this.globalEvents.bind("highlightNotificationBelow",this.highlightNotificationBelow,this);MW.Notifications.bind("reset",this.addNotificationsToContainer,this);MW.Notifications.bind("remove",this.addNotificationsToContainer,this);MW.Notifications.bind("add",this.addOneNewNotification,this);MW.Notifications.bind("modified",this.updateNotification,this);var b=MW.KeyboardShortcuts.setupContext("notification","showNotificationCard",this);b.addShortcut(107,this.highlightNotificationBelow);b.addShortcut(106,this.highlightNotificationAbove);b.addShortcut(13,this.renderFocusedDrilldown)},cleanUp:function(){MW.Notifications.off()},renderFocusedDrilldown:function(){MW.App.globalEvents.trigger("renderDrilldown",MW.Notifications.focused("mainFocused"))},highlightNotificationAbove:function(){if(!MW.Notifications.focusMain("down",this.isShowingAll())){this.showMoreNotifications("keyboard")}else{MW.App.scrollToFocusedMain()}},highlightNotificationBelow:function(){MW.Notifications.focusMain("up",this.isShowingAll());MW.App.scrollToFocusedMain()},isShowingAll:function(){return !MW.$(".mw-show-more").visible()},render:function(){var a=MW.$(this.el);this.renderTemplate(a);this.notificationList=a.find(".mw-notifications-list");return this},addNotificationsToContainer:function(){var c=this.notificationList;var a=MW.Notifications.main();c.empty();if(a.length===0){this.renderEmptyNotificationsTemplate(c)}else{this.addAllNotifications(a)}var b=MW.$(MyWork.Templates.showMore());if(MW.Notifications.countNested(a)<MW.MAX_RESULTS){b.addClass("hidden")}c.append(b)},addAllNotifications:function(a){var b=this;_.each(a,function(c){b.addOneNewNotification(c)})},updateNotification:function(a){setTimeout(_.bind(function(){var b=this.notificationList.find('li[aggregate-key="'+a.get("aggregateKey")+'"]');this.addOneNotification(a,b)},this))},addOneNewNotification:function(b){this.$el.find(".mw-no-notifications").remove();var a=new MW.NotificationView({model:b,globalEvents:this.globalEvents,attributes:{"aggregate-key":b.get("aggregateKey")}});this.addOneNotification(b,a.render().$el)},addOneNotification:function(e,d){var c=this.$el.find(".mw-notifications-list");var b=MW.Notifications.indexOf(e);var a=c.find(".mw-notification-item").eq(b);if(a.length===0){c.append(d)}else{if(a[0]!==d[0]){a.before(d)}}},showMoreNotificationsEvent:function(a){this.showMoreNotifications("click");a.preventDefault()},showMoreNotifications:function(d){var c=MW.$(".more-trigger");var b=MW.$('<li class="mw-loading-more" />');c.before(b);c.addClass("hidden").remove();var a=_.bind(function(g,e){b.remove();var f=_(e).reduce(function(h,i){return h+i.notifications.length},0);this.notificationList.append(c);if(f===MW.MAX_RESULTS){c.removeClass("hidden")}},this);MW.Notifications.fetchWithLimit({add:true,data:{before:MW.Notifications.beforeId},success:a});this.fireShowMoreAnalyticsEvent(d)},fireShowMoreAnalyticsEvent:function(a){AJS.EventQueue.push({name:"mywork.showmore",properties:{count:MW.Notifications.main().length,from:a||"click"}})},gotoTasks:function(){this.globalEvents.trigger("showTaskCard",1)}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/views/notification-entry-view.js' */
MW.NotificationEntryAbstractView=Backbone.View.extend({className:"mw-drilldown-list",events:{click:"focusSelected","click .authorise":"authorise","click .discard":"discard"},initialize:function(a){this.globalEvents=a.globalEvents;this.model.bind("change drilldownFocused",this.rerenderFocus,this)},cleanup:function(){this.model.off(null,null,this)},render:function(){var a=MW.$(this.el);var c=this.model;a.toggleClass("focused",c.get("drilldownFocused")||false);if(c.get("read")){a.addClass("collapsed")}var b="";b=this.createNotificationTitle(c);this.renderTemplate(a,{notification:c.toJSON(),htmlTitle:b});this.fixRelativeUrls();if(MW.Notifications.isMyWorkAuth(c.get("parent").attributes)){a.find(".mw-drilldown-excerpt").append(MW.$('<button class="authorise">'+"\u6388\u6743"+'</button><button class="discard">'+"\u653e\u5f03"+"</button>"))}this.ensureNoMissingImage(a.find(".mw-drilldown-avatar"),"useravatar");this.actionMessageView=new MW.ActionMessageView({el:a.find(".message").first(),aggregateKey:c.get("parent").get("aggregateKey")});this.addActions();return this},fixRelativeUrls:function(){var a=this.model.get("parent").config.getUrl(),b=a.split("/",3).join("/");this.$el.find("a").each(function(e,c){var d=MW.$(c).attr("href");if(!!d&&d.indexOf("/")===0){MW.$(c).attr("href",b+d)}})},rerenderFocus:function(){MW.$(this.el).toggleClass("focused",this.model.get("drilldownFocused")||false)},focusSelected:function(){this.globalEvents.trigger("focusClickedNotification",this.model)},htmlTitle:function(){var b=this.model.get("parent").entityI18n("this")||"\u6b64",a=MW.$.extend({title:b},this.model.get("metadata"));return this.model.get("parent").i18nHtml("title",a)||MW.escapeHTML(this.model.get("title"))},ensureNoMissingImage:function(b,a){b.error(function(){var c=MW.$("<span />");c.addClass(a);b.after(c);b.remove()})},addActions:function(){var b=MW.$(this.el),f=this.model,e=b.find(".mw-drilldown-actions ul"),a=b.find(".action-form"),c=f.get("actions").reverse();var d=this;MW.$.each(c,function(h,j){if(!MW.Configurations.getFromNotification(f.attributes)){return}var g=new MW.ActionView({model:j,url:f.get("url"),itemUrl:f.get("parent").get("url"),actionFormElement:a,notification:f,actions:c,target:"notification",actionMessageView:d.actionMessageView,globalEvents:d.globalEvents});e.prepend(g.render().el)});c.reverse();this.addTime(e,f.getPrettyTime())},authorise:function(){window.top.location.href=this.model.get("url")},discard:function(){var a=this.model;a.executeInlineAction({actionName:"dismissAuth",target:"notification",success:function(b){if(b.successful){MW.Tasks.remove(MW.Tasks.getByGlobalId(a.get("globalId")));MW.Notifications.remove(a.get("parent"));MW.App.gotoMain()}else{var c="\u672a\u77e5\u9519\u8bef";this.actionMessageView.showErrorMessage(c)}},error:function(c,d,b){if(c.status===401){this.actionMessageView.showLoginErrorMessage("\u4f60\u5c1a\u672a\u767b\u5f55\u7cfb\u7edf\u3002\u8bf7\u003ca href=\u0022#\u0022\u003e\u767b\u5f55\u003c/a\u003e.")}else{this.actionMessageView.showErrorMessage(b)}}})}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/views/drilldown-view.js' */
MW.DrilldownAbstractView=Backbone.View.extend({className:"mw-notification-drilldown card",events:{"click .mw-drilldown-top":"gotoMain","click .mw-header .nav button":"gotoMain"},initialize:function(a){this.globalEvents=a.globalEvents;this.reverseSlide=a.reverseSlide;this.globalEvents.bind("showNotificationDrilldownCard",this.showCard,this);this.globalEvents.bind("movetoDrilldownAbove",this.movetoDrilldownAbove,this);this.globalEvents.bind("movetoDrilldownBelow",this.movetoDrilldownBelow,this);this.globalEvents.bind("cleanupNestedCard",this.removeElementAndBindings,this);var b=MW.KeyboardShortcuts.setupContext("notificationDrilldown-"+this.model.get("aggregateKey"),"showNotificationDrilldownCard",this);b.addShortcut(13,this.openDrilldownObject);b.addShortcut(106,this.gotoAboveNotification);b.addShortcut(107,this.gotoBelowNotification);b.addShortcut(110,this.movetoDrilldownBelow);b.addShortcut(112,this.movetoDrilldownAbove);b.addShortcut(115,this.createTaskFromDrilldown);b.addShortcut(117,this.gotoMain);this.kb=b},gotoAboveNotification:function(){this.globalEvents.trigger("highlightNotificationAbove");this.renderDrilldown(false)},gotoBelowNotification:function(){this.globalEvents.trigger("highlightNotificationBelow");this.renderDrilldown(true)},renderDrilldown:function(b){var a=MW.Notifications.focused("mainFocused");if(this.model!=a){this.globalEvents.trigger("renderDrilldown",a,false,b)}},createTaskFromDrilldown:function(){this.headerView.createTask()},movetoDrilldownAbove:function(){var a=this.model.focused();var b=this.model.focusOlder();if(a===b){MW.App.scrollToDrilldownHeader()}else{MW.App.scrollToFocusedDrilldown();if(_(this.collapsedGroup).contains(b)){this.showOlder(function(){MW.App.scrollToFocusedDrilldown()})}}},movetoDrilldownBelow:function(){this.model.focusNewer();MW.App.scrollToFocusedDrilldown()},openDrilldownObject:function(){var a=this.model.focused().get("url");window.open(a)},render:function(){var k=MW.$(this.el),f=this,b=this.model,i=this.model.notifications;this.renderTemplate(k);var e=k.find(".mw-drilldown-header"),c=k.find(".mw-drilldown-body");this.collapsedGroup=_.filter(i,function(l){return l.get("read")});var g=this.collapsedGroup.length;var h=i.length-g;this.headerView=new MW.HeaderView({el:e,model:b,numUpdates:h,globalEvents:this.globalEvents});this.headerView.render();this.entryViews=[];_.each(i,function(m){var l=new MW.NotificationEntryView({model:m,globalEvents:f.globalEvents,attributes:{"notification-id":m.get("id")}});c.prepend(l.render().el);f.entryViews.push(l)});var j=k.find(".mw-drilldown-list.collapsed");if(g===i.length){g-=1;j.last().removeClass("collapsed");j=k.find(".mw-drilldown-list.collapsed")}j.wrapAll("<div class='collapsed-group'/>");if(g){c.prepend("<div class='mw-collapsed-header'></div>");var d=c.find(".mw-collapsed-header");d.click(function(l){setTimeout(function(){f.showOlder(function(){f.model.focusOldest()})},0);l.preventDefault()});var a=this.model.i18ns("older",g);d.html("<a href='#'>"+a+"</a>")}return this},showOlder:function(b){var a=this.$el.find(".mw-collapsed-header");if(a.length===0){return}this.showCollapsedGroup(MW.$(".collapsed-group"),b);a.remove()},gotoMain:function(){this.globalEvents.trigger("showNotificationCard")},removeElementAndBindings:function(){if(!this.$el.hasClass("showing")){this.globalEvents.off(null,null,this);this.kb.cleanup();this.headerView.removeBindings();_.each(this.entryViews,function(a){a.cleanup()});this.undelegateEvents();this.remove()}},showCard:function(a){if(!this.$el.hasClass("showing")){MW.Router.navigateToNotification(this.model.get("aggregateKey"));if(this.reverseSlide){this.showCardAnimationReverseSlide(a)}else{this.showCardAnimation(a)}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/views/taskdetail-view.js' */
MW.TaskDetailAbstractView=Backbone.View.extend({tagName:"div",className:"mw-taskdetail card",events:{"click .mw-drilldown-top":"gotoTasks","click .mw-taskdetail-save":"gotoTasks","click .mw-header .nav button":"gotoTasks","keypress .mw-taskdetail-notes-textarea":"handleNotesKeypress","keypress .mw-taskdetail-title":"handleTitleKeypress","click .mw-taskdetail-notes":"editNotes","mousedown .mw-taskdetail-notes":"mouseNotes","focus .mw-taskdetail-notes":"focusNotes","focusout .mw-taskdetail-notes-textarea":"saveNotes","focusout .mw-taskdetail-title":"saveTitle","click .mw-taskdetail-delete":"deleteTask","click .mw-task-checkbox":"toggleCompleted"},initialize:function(a){this.globalEvents=a.globalEvents;this.globalEvents.bind("deleteTask",this.removeTask,this);this.globalEvents.bind("cleanupNestedCard",this.removeElementAndBindings,this);MW.KeyboardShortcuts.changeContext("taskDetail")},toggleCompleted:function(){if(this.completedCheckbox.hasClass("completed")){this.model.setState("TODO")}else{this.model.setState("DONE")}this.renderCompleteState()},showCard:function(a){MW.Router.navigateToTask(this.model.id);this.showCardAnimation(a)},handleNotesKeypress:function(a){a.stopPropagation();this.renderTags()},handleTitleKeypress:function(a){this.renderTags();if(a.keyCode==13){this.saveTitle();a.preventDefault()}},mouseNotes:function(){this.mouse=true},focusNotes:function(){if(!this.mouse){this.editNotes()}},editNotes:function(){this.mouse=false;this.notesTextareaDiv.hide();this.relatedContent.addClass("selected");var b=this.notesTextarea.val().length;var a=this.notesTextarea.show().focus()[0];if(a.setSelectionRange){a.setSelectionRange(b,b)}},saveNotes:function(){var a=this.notesTextarea.val();this.updateModel(function(){this.model.setNotes(a);this.updateNotes(a);this.notesTextarea.hide();this.notesTextareaDiv.show();this.relatedContent.removeClass("selected")})},updateNotes:function(b){var a=this.convertLinks(MW.$("<pre />").text(b).html());if(!a){this.notesTextareaDiv.addClass("placeholder").text("\u589e\u52a0\u4e00\u4e9b\u8bf4\u660e")}else{this.notesTextareaDiv.removeClass("placeholder").html(a)}this.notesTextarea.val(b)},convertLinks:function(c){var b=/(\b(https?|ftp|file):\/\/[\-A-Z0-9+&@#\/%?=~_|!:,.;]*[\-A-Z0-9+&@#\/%=~_|])/ig;var a=String.fromCharCode(160);return c.replace(/ {2}/g,a+a).replace(/\n/g,"<br />").replace(b,"<a href='$1' target='_blank'>$1</a>")},saveTitle:function(){this.updateModel(function(){this.model.setTitle(this.getTitleText())})},updateModel:function(a){_.bind(a,this)()},deleteTask:function(a){a.preventDefault();this.showDeleteConfirmation()},removeTask:function(){this.model.destroy();this.globalEvents.trigger("showTaskCardBack")},getTitleText:function(){return this.titleInput.val()||this.titleInput.text()},getNotesText:function(){return this.model.get("notes")||""},gotoTasks:function(){this.saveTitle();this.saveNotes();this.globalEvents.trigger("showTaskCardBack")},removeElementAndBindings:function(){if(!this.$el.hasClass("showing")){this.model.off(null,null,this);this.globalEvents.off(null,null,this);this.undelegateEvents();this.remove()}},render:function(){var b=MW.$(this.el);var c=b.children().length===0;if(c){this.renderTemplate(b)}this.titleInput=b.find(".mw-taskdetail-title");this.notesTextarea=b.find(".mw-taskdetail-notes-textarea");this.notesTextareaDiv=b.find(".mw-taskdetail-notes");this.relatedContent=b.find(".mw-related-content");var a=this.getNotesText();this.updateNotes(a);if(c){this.notesTextarea.hide()}this.completedCheckbox=b.find(".mw-task-checkbox");this.container=b.find(".mw-taskdetail-container");this.renderTagPlaceholder();this.renderCompleteState();if(this.model.get("readonlyTitle")){this.titleInput.attr("title","\u6253\u5f00\u9875\u9762\u7f16\u8f91\u4efb\u52a1")}this.relatedContent.attr("title","\u6253\u5f00\u76f8\u5173\u94fe\u63a5");return this},renderCompleteState:function(){var a=this.model.isCompleted();this.completedCheckbox.toggleClass("completed",a);this.container.toggleClass("completed",a)},renderTagPlaceholder:function(){if(!!AJS.DarkFeatures&&AJS.DarkFeatures.isEnabled("nat.tags")){MW.$(".mw-taskdetail-container").append(MyWork.Templates.taskDetailTags({task:this.model.attributes}));this.renderTags()}},renderTags:function(){if(!!AJS.DarkFeatures&&AJS.DarkFeatures.isEnabled("nat.tags")){var e=this.getTitleText(),c=this.notesTextarea.val(),f=e+" "+c,d=/(^|\s)#(\w+)/g,b=f.match(d),a=MW.$(this.el).find(".mw-taskdetail-taglist");a.empty();if(!b){a.addClass("empty");a.text("\u901a\u8fc7\u6dfb\u52a0\u4e00\u4e2a #tag \u6765\u7ec4\u7ec7\u60a8\u7684\u4efb\u52a1")}else{a.removeClass("empty");_.each(b,function(g){a.append(MyWork.Templates.categoryLabel({text:g.split("#")[1]}))})}}},isInlineTask:function(){return this.model.get("application")==="com.atlassian.confluence"&&this.model.get("entity")==="inline-task"}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/views/task-main-view.js' */
MW.TaskMainAbstractView=Backbone.View.extend({tagName:"div",className:"mw-tasks card",completed:false,events:{"keypress #new-personal-task":"createOnEnter","keyup #new-personal-task":"disableAddTask","input #new-personal-task":"disableAddTask","click .add-task":"addPersonalTask","click .view-completed":"toggleCompleted","click .mw-button-notifications":"gotoNotifications","click .view-completed-mobile":"showCompleted","click .view-uncompleted-mobile":"showUncompleted"},gotoNotifications:function(){this.globalEvents.trigger("showNotificationCard",1)},initialize:function(a){this.globalEvents=a.globalEvents;this.globalEvents.bind("addPersonalTask",this.addPersonalTask,this);this.globalEvents.bind("showTaskDetail",this.showTaskDetail,this);this.globalEvents.bind("showTaskByGlobalId",this.showTaskByGlobalId,this);this.globalEvents.bind("showTaskCard",this.showTaskCard,this);this.globalEvents.bind("showTaskCardBack",this.showCard,this);MW.Tasks.bind("fetch",this.loaded,this);MW.KeyboardShortcuts.setupContext("task","showTaskCard",this);MW.$(document).bind("keydown",_.bind(this.focusInput,this))},cleanUp:function(){MW.Tasks.off()},focusInput:function(){this.input.focus()},showTaskByGlobalId:function(a){this.showTaskDetail(MW.Tasks.getByGlobalId(a))},showTaskDetail:function(a,b){var c=new MW.TaskDetailView({model:a,globalEvents:this.globalEvents});this.renderShowTaskDetailView(c,b);c.showCard()},showTaskCard:function(a){this.completed=false;this.showCard(a)},addTodo:function(){if(!this.taskList){return}var b=this;this.taskList.empty();var a=MW.Tasks.todo();if(a.length===0){this.renderEmptyTaskTemplate(this.taskList)}else{_.each(a,function(c){b.addOneTask(c)});this.makeTasksSortable()}if(this.viewCompleted){this.viewCompleted.toggle(MW.Tasks.done().length!==0)}},render:function(){var a=MW.$(this.el);this.renderTemplate(a);this.input=a.find("#new-personal-task");this.viewCompleted=a.find(".view-completed");this.addTask=a.find(".add-task");this.taskList=a.find(".mw-tasks-list");this.disableAddTask();return this},showLoading:function(){this.taskList.empty();var a=new ConfluenceMobile.Notification(this.taskList);a.showLoading()},loaded:function(){if(this.completed){this.addDone()}else{this.addTodo()}},addOneTask:function(c,b){MW.$(".mw-no-tasks").hide();var a=new MW.TaskView({model:c,globalEvents:this.globalEvents,attributes:{"task-cid":c.cid}});if(b){this.taskList.prepend(a.render().el)}else{this.taskList.append(a.render().el)}},createOnEnter:function(a){if(a.which!=13){return}this.addPersonalTask()},addPersonalTask:function(){var b=this.input.val();if(!MW.$.trim(b)){return}if(this.completed){this.showUncompleted()}var a=this.createPersonalTask(b);a.set("displayName",b);this.taskList.scrollTop(0);this.input.val("");this.disableAddTask()},createPersonalTask:function(b){var a=MW.Tasks.create({application:"com.atlassian.mywork.host.provider",entity:"notes",status:"TODO",title:b},{at:0});this.addOneTask(a,true);return a},show:function(){if(MW.Tasks.hasFetched.isResolved()){this.completed?this.showCompleted():this.showUncompleted()}},toggleCompleted:function(){!this.completed?this.showCompleted():this.showUncompleted()},addDone:function(){this.taskList.empty();if(MW.Tasks.done().length===0){this.renderEmptyCompletedTemplate(this.taskList)}else{var b=new Date();var a=new Date(b.getFullYear(),b.getMonth(),b.getDate());var c=new Date(b.getFullYear(),b.getMonth(),b.getDate()-1);this.addListWithCategory(MW.Tasks.doneNewerThan(a),"\u4eca\u65e5");this.addListWithCategory(MW.Tasks.doneBetween(c,a),"\u6628\u5929");this.addListWithCategory(MW.Tasks.doneOlderThan(c),"\u4ee5\u524d\u7684")}},addListWithCategory:function(c,b){var a=this;if(!!c.length){this.taskList.append(MyWork.Templates.completedCategory({category:b}));_.each(c,function(d){a.addOneTask(d)})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/views/action-message-view.js' */
MW.ActionMessageView=Backbone.View.extend({showErrorMessage:function(a){if(!a){a="\u554a\uff0c\u4e0d\u597d\uff01\u51fa\u9519\u4e86\u3002\u68c0\u67e5\u60a8\u7684\u7f51\u7edc\u8fde\u63a5\u7136\u540e\u518d\u8bd5\u3002"}this.$el.text(a)},showLoginErrorMessage:function(a){this.$el.html(a);this.$("a").click(function(b){b.preventDefault();if(MW.App.parseView()==="mobile"){ConfluenceMobile.loadLoginScreen(true)}else{location.reload()}})},showOAuthErrorMessage:function(c,b){var a=b,d=MW.createCallback(MW.getBaseUrl(),this.options.aggregateKey);if(d){a+=MW.appendCallback(a,d)}this.$el.html(c);this.$("a").attr("href",a)},clearMessage:function(){this.$el.empty()}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/views/action-view.js' */
MW.ActionAbstractView=Backbone.View.extend({tagName:"li",className:"action-item",disabled:false,events:function(){return{click:"clickEvent"}},disableFormElements:function(){var a=this.options.actionFormElement;a.find("input").addClass("disabled").attr("disabled","disabled")},enableFormElements:function(){var a=this.options.actionFormElement;a.find("input").removeClass("disabled").removeAttr("disabled")},showSuccessMessage:function(d){var a=this.model.attrs||{};if(a.alternateAction){var c=this.model;this.model=a.getAlternateAction();this.options.actions[_.indexOf(this.options.actions,c)]=this.model;this.render();return}if(a.allowOnceOnly){this.disableActionElement()}var b=this.actionI18n("alternateDisplayName");if(b){this.toggleDisplayName(this.actionI18n("displayName"),b,a.responseLink)}if(a.responseLink){this.$el.unbind().find("a").attr("target","_blank").attr("href",d)}},makeAjaxRequest:function(a,e,c){var g=this,i=this.model.attrs||{},h=this.options.actionFormElement,b=g.options.actionMessageView;this.disableActionElement();h.find(".aui-button-primary").addClass("disabled");h.find(".mw-loading").addClass("show");var f=this.addDots();var d=function(){f();g.enableActionElement();h.find(".aui-button-primary").removeClass("disabled");h.find(".mw-loading").removeClass("show")};var j=function(k){d();b.clearMessage();h.parent().removeClass("expanded");a?a(k):g.showSuccessMessage(k)};this.options.notification.executeInlineAction({actionName:this.model.id,target:this.options.target,extraData:c,success:function(k){if(k.successful){if(!i.instant){j()}}else{d();var l=g.i18n(k.messageKey)||k.message||"\u672a\u77e5\u9519\u8bef";if(e){e(l,null,k.authUrl)}else{if(k.authUrl){b.showOAuthErrorMessage("\u6388\u6743\u5931\u8d25\u3002\u8bf7\u003ca\u003e\u6388\u6743\u003c/a\u003e\u3002",k.authUrl)}else{b.showErrorMessage(l)}}}},error:function(l,m,k){d();if(e){e(k,l)}else{if(l.status===401){b.showLoginErrorMessage("\u4f60\u5c1a\u672a\u767b\u5f55\u7cfb\u7edf\u3002\u8bf7\u003ca href=\u0022#\u0022\u003e\u767b\u5f55\u003c/a\u003e.")}else{b.showErrorMessage(k)}}}});if(i.instant){j()}},addDots:function(){var a=MW.$(this.el).find("a");var b=a.text();a.text(b+"...");return function(){a.text(b)}},clickEvent:function(c){var a=this.model.type,b=this;if(this.disabled){return false}if(a!=="link"&&a!=="taskLink"){c.preventDefault()}if(a==="ajax"){this.makeAjaxRequest(null,null,null)}if(a==="form"){var d=this.options.actionFormElement;d.find("form").remove();d.append(this.renderForm());d.parent().addClass("expanded");this.showForm(d)}},toggleDisplayName:function(a,e,d){var c;if(!!d){c=MW.$(this.el).find("a")}else{c=MW.$(this.el);c.unbind()}var b=(c.text()===a)?e:a;c.text(b)},disableActionElement:function(){this.setDisabled(true)},enableActionElement:function(){this.setDisabled(false)},setDisabled:function(a){this.disabled=a;MW.$(this.el).toggleClass("disabled",a)},removeForm:function(){var a=this.options.actionFormElement;if(a.visible()){a.find("textarea").blur();a.remove();this.enableActionElement()}},doFormBindings:function(a){var b=this;a.keypress(function(d){d.stopPropagation()});var c=function(){var f=a.find(".aui-button-primary");var d=a.find("textarea");var e=d.val().length>0;f.toggleClass("disabled",!e);if(e){f.removeAttr("disabled")}else{f.attr("disabled","disabled")}};a.keyup(c);c();a.find(".inline-cancel").click(function(d){d.preventDefault();b.removeForm()});a.submit(function(f){b.disableFormElements();var d=a.serializeObject();a.find("textarea").blur().attr("disabled","disabled");b.makeAjaxRequest(function(e){b.showSuccessMessage(e);b.removeForm()},function(h,i,e){var g=b.options.actionMessageView;a.find("textarea").removeAttr("disabled");if(i&&i.status===401){g.showLoginErrorMessage("\u60a8\u672a\u767b\u5f55\u3002\u60a8\u53ef\u80fd\u60f3\u590d\u5236\u60a8\u6240\u505a\u7684\u53d8\u66f4\u5e76\u91cd\u65b0\u003ca href=\u0022#\u0022\u003e\u767b\u5f55\u003c/a\u003e\u3002")}else{if(e){g.showOAuthErrorMessage("\u6388\u6743\u5931\u8d25\u3002\u60a8\u53ef\u80fd\u60f3\u590d\u5236\u60a8\u6240\u505a\u7684\u66f4\u6539\u5e76\u003ca\u003e\u6388\u6743\u003c/a\u003e\u3002",e)}else{g.showErrorMessage(h)}}b.enableFormElements()},d);return false})},renderForm:function(){this.disableActionElement();var c=this,b=this.getFormContainerTemplate(),a=MW.$(b);_.each(this.options.model.data,function(f){var e;if(f.type==="textarea"){e=c.getFormTextareaTemplate()}a.append(e)});var d=this.getFormActionButtonsTemplate({submitLabel:this.actionI18n("submitLabel")});a.append(d);this.doFormBindings(a);return a},render:function(){var e=MW.$(this.el);e.empty();if(this.model.type==="link"){var h=this.options.notification;var g=h.toJSON();var c=this.options.url;if(this.model.url){var b=MW.Configurations.getFromNotification(h.attributes);var f=b?b.get("url"):MW.contextPath;c=f+MW.formatString(this.model.url,Mw.$.extend({globalId:g.globalId},g.metadata))}var d=this.actionI18n("displayName")||"\u6253\u5f00";var a=MW.$(MyWork.Templates.openLinkAction({notification:g,url:c,displayName:d}));a.mouseup(function(){h.get("parent").trigger("open",h)});e.append(a)}else{if(this.model.type==="taskLink"){e.append(MW.$("<a>").attr("href",this.options.url).attr("target","_blank").text(this.actionI18n("displayName")))}else{e.append(MW.$("<a href='#'>"+this.actionI18n("displayName")+"</a>"))}}if(this.actionI18n("title")){e.attr("title",this.actionI18n("title"))}return this},actionI18n:function(a){var b=this.model.id;return this.i18n("action."+b+"."+a)},i18n:function(a){var d=this.options.notification.toJSON(),c=d.parent.config,b=d.parent.get("application");return c.i18n(b+"."+a)}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/views/header-view.js' */
MW.HeaderAbstractView=Backbone.View.extend({events:{"click .mw-task":"selectTask"},initialize:function(a){this.globalEvents=a.globalEvents},removeBindings:function(){this.$el.unbind();this.model.off(null,null,this)},render:function(){var e=MW.$(this.options.el),d=this.options.model,c=this.htmlTitle();if(!c){return}var b=d.has("globalId")&&!(d.get("application")==="com.atlassian.mywork.providers.confluence"&&d.get("action").indexOf("task.")===0)&&!d.get("pinned");var a=MW.$.extend({},d.attributes,{title:c,newActionsText:this.newActionsText(),renderTask:b,hasTask:d.hasTask()});this.renderTemplate(e,a,d);this.addActions()},htmlTitle:function(){var a=this.model.notifications,b=a[0].get("metadata");return this.model.i18nHtml("itemtitle",b)||MW.escapeHTML(this.model.get("title"))},newActionsText:function(){var c=this.options.model,e=this.options.numUpdates,f=c.entityI18n("this")||"\u6b64",a=c.entityI18n("entity")||c.get("entity"),b=f+" "+a,d=c.i18ns("aggregatenew",e,b);if(e===0){d=c.i18ns("aggregate",c.notifications.length,b)}return d},addActions:function(){var g=this,e=this.model,c=this.model.notifications[0],d=MW.$(this.options.el);var b=MW.$(".drilldown-header-title > .mw-drilldown-actions"),a=d.find(".mw-drilldown-actions > ul");var f=new MW.ActionMessageView({el:d.find(".message").first(),aggregateKey:e.get("aggregateKey")});_.each(e.get("objectActions"),function(i){var h=new MW.ActionView({model:i,url:e.get("url"),itemUrl:e.get("url"),actionFormElement:d.find(".action-form"),notification:c,actions:e.get("objectActions"),actionMessageView:f,target:"object",actionElement:b,globalEvents:g.globalEvents});a.append(h.render().el)})},selectTask:function(){if(this.model.hasTask()){this.globalEvents.trigger("showTaskByGlobalId",this.model.get("globalId"))}else{this.createTask()}},_getRelatedTaskButton:function(){return MW.$(this.options.el).find(".drilldown-task-container .mw-task")},createTask:function(){this._getRelatedTaskButton().addClass("loading");this.model.createTask(_.bind(this.taskCreated,this))},taskCreated:function(){this._getRelatedTaskButton().removeClass("loading").addClass("on")}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/routes.js' */
MW.$(function(){MW.Router=Backbone.Router.extend({initialize:function(a){this.globalEvents=a.globalEvents},routes:{notification:"notifications",task:"tasks","notification/:id":"notification","task/:id":"task","*path":"initial"},navigateToMain:function(a){a=this.setDefaultOptions(a);this.navigate("notification",a)},navigateToNotification:function(b,a){a=this.setDefaultOptions(a);this.navigate("notification/"+b,a)},navigateToTasks:function(a){a=this.setDefaultOptions(a);this.navigate("task",a)},navigateToTask:function(b,a){a=this.setDefaultOptions(a);this.navigate("task/"+b,a)},setDefaultOptions:function(a){a=a||{};_.extend(a,{replace:MW.$(".miniview-page").hasClass("iframe")});return a},initial:function(){MW.App.gotoInitial()},notifications:function(){MW.App.gotoMain()},tasks:function(){MW.App.gotoTasks()},notification:function(b){var a=this;MW.Notifications.getByAggregateKeyDeferred(b,function(c){if(_.isEmpty(c)){return a.notifications()}MW.Notifications.setFocused(c);a.globalEvents.trigger("renderDrilldown",c)})},taskByGlobalId:function(a){MW.Tasks.getByGlobalIdDeferred(a,_.bind(this.task,this))},task:function(a){MW.Tasks.getByIdDeferred(a,_.bind(function(b){if(!b){return this.tasks()}MW.App.completed=!b.isCompleted();this.globalEvents.trigger("showTaskDetail",b)},this))}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/views/miniview/notification-views.js' */
MW.NotificationMainView=MW.NotificationMainAbstractView.extend({renderEmptyNotificationsTemplate:function(a){a.html(MyWork.Templates.noNotifications({heading:"Hi!",subheading:"\u4f60\u4e00\u4e2a\u901a\u77e5\u4e5f\u6ca1\u6709\u3002",body:soydata.VERY_UNSAFE.ordainSanitizedHtml("\u003cp\u003e\u65b0\u901a\u77e5\u5728\u8fd9\u91cc\u51fa\u73b0\uff0c\u5f53\u5176\u5b83\u4eba\uff1a\u003c/p\u003e\u003cul\u003e\u003cli\u003e\u4e0e\u4f60\u5206\u4eab\u5185\u5bb9\u003c/li\u003e\u003cli\u003e\u5728\u8bc4\u8bba\u3001\u9875\u9762\u6216\u8005\u535a\u5ba2\u4e2d\u63d0\u5230\u4f60\u003c/li\u003e\u003cli\u003e\u56de\u590d\u6216\u559c\u6b22\u4f60\u521b\u5efa\u7684\u5185\u5bb9\u003c/li\u003e\u003c/ul\u003e")}))},renderTemplate:function(a){a.html(MyWork.Templates.mainNotification());a.find(".mw-button-notifications").toggleClass("on",true)},showCard:function(a){MW.Router.navigateToMain();MW.Cookie.save(false);MW.CardAnimation.showCard(MW.$(this.el),MW.Slide.FROM_LEFT,a,function(){MW.App.scrollToFocusedMain()})}});MW.NotificationView=MW.NotificationAbstractView.extend({initialize:function(){MW.NotificationView.__super__.initialize.apply(this,arguments);this.globalEvents.on("showNotificationCard",this.updateTime,this);this.globalEvents.on("reopenMiniview",this.updateTime,this);this.globalEvents.on("markAllRead",this.updateSeen,this)},updateTime:function(){this.$el.find(".mw-notification-time").text(this.model.getPrettyTime())},updateSeen:function(){MW.Notifications.setNotificationsAsRead(this.model.notifications,true);this.updateTitle();this.$el.removeClass("unread")},renderTemplate:function(a){a.html(MyWork.Templates.notificationView({notification:this.model.toJSON(),prettyTime:this.model.getPrettyTime()}))},renderDrilldownTemplate:function(a){MW.$("#mw-container").append(a.render().el);this.globalEvents.trigger("showNotificationDrilldownCard")}});MW.NotificationEntryView=MW.NotificationEntryAbstractView.extend({createNotificationTitle:function(){return this.htmlTitle()},addTime:function(a,b){a.prepend(MW.$("<li />").text(b))},renderTemplate:function(a,b){a.html(MyWork.Templates.drilldownEntry(b))}});MW.HeaderView=MW.HeaderAbstractView.extend({renderTemplate:function(a,b,c){a.html(MyWork.Templates.drilldownHeader(b));if(c.get("action")&&c.get("action").indexOf("task.")===0){a.find(".drilldown-star-container").hide()}}});MW.DrilldownView=MW.DrilldownAbstractView.extend({renderTemplate:function(a){a.html(MyWork.Templates.notificationDrilldown())},showCardAnimation:function(a){MW.CardAnimation.showCard(MW.$(this.el),MW.Slide.FROM_RIGHT,a)},showCardAnimationReverseSlide:function(a){MW.CardAnimation.showCard(MW.$(this.el),MW.Slide.FROM_LEFT,a)},showCollapsedGroup:function(a,b){a.slideToggle(300,function(){a.focus();if(b){b()}})}});MW.ActionView=MW.ActionAbstractView.extend({showForm:function(a){a.slideDown(100,function(){MW.App.scrollToFocusedElement(".mw-drilldown-container",".mw-notification-drilldown",a.parents(".mw-drilldown-list"));a.find("textarea").first().each(function(c,b){if(b.setSelectionRange){b.focus();b.setSelectionRange(0,0)}})})},renderForm:function(){var a=MW.ActionAbstractView.prototype.renderForm.apply(this,arguments);MW.makeTextAreaExpandable(a,function(){MW.App.scrollToFocusedElement(".mw-drilldown-container",".mw-notification-drilldown",MW.$(".inline-action-submit"))});return a},getFormContainerTemplate:function(){return MyWork.Templates.inlineActionForm()},getFormTextareaTemplate:function(){return MyWork.Templates.inlineActionTextarea()},getFormActionButtonsTemplate:function(a){return MyWork.Templates.inlineActionSubmit(a)}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/views/miniview/deprecated-tasks-view.js' */
MW.DeprecatedTasksView=Backbone.View.extend({tagName:"div",className:"mw-tasks card",events:{"click .mw-button-notifications":"gotoNotifications","click #mw-deprecated-task-show-me":"closeAndShowFeatureDiscovery","click #mw-deprecated-task-dissmiss":"close"},initialize:function(a){this.globalEvents=a.globalEvents;this.globalEvents.bind("showTaskCard",this.showTaskCard,this);this.userMustMigrate=(MW.$("meta[name='mw-should-migrate-tasks']").attr("content")==="true")},render:function(){var a=MW.$(this.el);this.renderTemplate(a);MW.Cookie.save(false);return this},showTaskCard:function(a){this.completed=false;this.showCard(a);this.migrateIfNeeded()},showCard:function(a){MW.Router.navigateToTasks();MW.CardAnimation.showCard(MW.$(this.el),MW.Slide.FROM_LEFT,a)},renderTemplate:function(a){a.html(MyWork.Templates.deprecatedTasks({userMustMigrate:this.userMustMigrate}));a.find(".mw-button-tasks").toggleClass("on",true)},gotoNotifications:function(){this.globalEvents.trigger("showNotificationCard",1)},closeAndShowFeatureDiscovery:function(a){this.parentCloseAndDiscoverMyTasks();a.preventDefault()},close:function(a){this.parentClose();a.preventDefault()},migrateIfNeeded:function(){var a=this;if(a.userMustMigrate){AJS.$.ajax({type:"POST",contentType:"application/json",data:{},url:MW.contextPath+"/rest/mywork/latest/task/migrateTasks"}).done(function(){a.userMustMigrate=false;a.render()})}else{AJS.$.ajax({type:"POST",contentType:"application/json",data:{},url:MW.contextPath+"/rest/mywork/latest/task/hasInteracted"}).done(function(){a.userMustMigrate=false;a.render()})}},parentCloseAndDiscoverMyTasks:function(){window.parent.MW.Tasks.closeAndDiscoverMyTasks()},parentClose:function(){window.parent.MW.Dialog.hide()}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/mywork.js' */
AJS.EventQueue=AJS.EventQueue||[];MW.MAX_RESULTS=parseInt(MW.getParameterByNameFromHash("max")||"0",10)||30;MW.$(function(){var a=_.extend({},Backbone.Events);MW.globalEvents=a;MW.contextPath=MW.$("meta[name=context-path]").attr("content");MW.configurationVersion=MW.$("meta[name='mw-configuration-version']").attr("content");MW.setRequestTime(MW.$("meta[name='mw-request-time']").attr("content"));MW.Configurations=new MW.ConfigurationCollection();MW.Notifications=new MW.NotificationCollection([],{globalEvents:a,config:MW.Configurations});MW.Tasks=new MW.TaskCollection([]);MW.KeyboardShortcuts=new MW.KeyboardShortcuts(a);MW.CardAnimation=new MW.CardTransitions({globalEvents:a});MW.AppView=Backbone.View.extend({el:MW.$("#mw-container"),count:0,render:function(){},initialize:function(d){var f=this;this.globalEvents=d.globalEvents;this.renderNotificationMain();var c=(MW.$("meta[name='mw-user-has-interacted-with-deprecated-task-mw']").attr("content")==="true");var e=(MW.$("meta[name='mw-user-has-tasks-to-migrate']").attr("content")==="true");if(!e||c){MW.$(".mw-toggles.toolbar-group").addClass("hide")}else{this.renderDeprecatedTaskMain()}MW.Notifications.bind("all",this.render,this);MW.Notifications.bind("open",this.openNotification,this);MW.Tasks.bind("all",this.render,this);MW.onJsonMessage(function(h){if(h.unread){g(h.unread)}else{if(h.markAllRead){f.globalEvents.trigger("markAllRead")}}});function g(h){MW.Notifications.fetcher({success:function(){AJS.EventQueue.push({name:"notificationtabopened",properties:{tasks:MW.Tasks.length,unread:h,loadedBy:MW.App.parseView()}});f.gotoInitial(h)}});MW.Tasks.fetchOnce();f.globalEvents.trigger("reopenMiniview")}if(MW.parentConfig.preload){MW.$(window.top).focus()}MW.Configurations.fetchOnce().done(function(){if(MW.parentConfig.preload){return}MW.Notifications.fetcher();MW.Tasks.fetchOnce()});MW.Tasks.bind("destroy",function(h){MW.Notifications.setStatusByGlobalId(h.get("globalId"),"")})},renderNotificationMain:function(){var c=new MW.NotificationMainView({globalEvents:this.globalEvents});MW.$("#mw-container").append(c.render().el)},renderDeprecatedTaskMain:function(){var c=new MW.DeprecatedTasksView({globalEvents:a});MW.$("#mw-container").append(c.render().el)},gotoInitial:function(){if(MW.parentConfig.unread=="0"&&MW.Cookie.load()){if(!MW.$(".mw-tasks").is(":visible")){MW.App.gotoTasks(1)}}else{if(!MW.$(".mw-notifications").is(":visible")){MW.App.gotoMain(1)}}},gotoTasks:function(){MW.Router.navigateToTasks();this.globalEvents.trigger("showTaskCard",1);if(!this.gotoTasksOnce){AJS.EventQueue.push({name:"tasktabopened",loadedBy:MW.App.parseView()});this.gotoTasksOnce=true}MW.Cookie.save(true)},gotoMain:function(){MW.Router.navigateToMain();this.globalEvents.trigger("showNotificationCard",1);MW.Cookie.save(false)},parseView:function(){if(window.top===window.self){return"homepage"}else{if(window.location.href.indexOf("anchorTarget=_blank")!=-1){return"chrome"}}},scrollToFocusedElement:function(d,g,f){var c=MW.$(d),h=MW.$(g||d);var e=f||MW.$(c).find(".focused");if(!!e.length){var i=c.scrollTop()+e.position().top-h.position().top;c.scrollTop(Math.max(c.scrollTop(),i-c.height()+e.outerHeight(true)));c.scrollTop(Math.min(c.scrollTop(),i))}},scrollToFocusedDrilldown:function(){this.scrollToFocusedElement(".mw-drilldown-container",".mw-notification-drilldown")},scrollToFocusedMain:function(){this.scrollToFocusedElement(".mw-notifications-list")},scrollToDrilldownHeader:function(){this.scrollToFocusedElement(".mw-drilldown-container",".mw-drilldown-container",MW.$(".mw-drilldown-header"))},openNotification:function(c){AJS.EventQueue.push({name:"mywork.notificationlinkopened",properties:c.toEventJSON()})}});var b=function(){MW.App=new MW.AppView({globalEvents:a});MW.Router=new MW.Router({globalEvents:a});Backbone.history.start({root:MW.contextPath+"/plugins/servlet/"+window.location.pathname.match(/servlet\/([^\/]*(?:\/m)?)?\/?/)[1]+"/"})};MW.parentConfig={};if(window.top!=window.self){MW.$(".miniview-page").addClass("iframe");MW.$("body").bind("click",function(c){c.stopPropagation()});MW.onJsonMessage(function(d,c){if(d.parentConfig&&c.source===parent){MW.parentConfig=d.parentConfig;b()}});parent.postMessage("getParentConfig","*")}else{b()}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-miniview', location = 'js/kb-shortcuts.js' */
MW.KeyboardShortcuts=function(b){var e={},c={},d=false;var a=function(){MW.$(document).bind("keydown",function(f){if(f.which==27){parent.postMessage("escKey","*")}});MW.$(document).bind("keypress",function(g){var f=e.keyPressed(g.which);if(f){g.preventDefault();g.stopPropagation()}});b.on("blockKeyboardShortcut",function(){d=true});b.on("unblockKeyboardShortcut",function(){d=false})};e.addShortcut=function(h,j,g,f){var i=c[g];i=i||{};i[h]=_.bind(j,f);c[g]=i};e.setupContext=function(i,h,g){var f=function(){e.changeContext(i)};b.on(h,f);return{cleanup:function(){b.off(h,f);c[i]={}},addShortcut:function(j,k){e.addShortcut(j,k,i,g)}}};e.changeContext=function(f){e.context=f};e.keyPressed=_.debounce(function(f){if(!d){var h=c[e.context]||{};var g=h[f];if(g){g();return true}}},30);e.clearShortcuts=function(){c={}};a();return e};
}catch(e){WRMCB(e)};